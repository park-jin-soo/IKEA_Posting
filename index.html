<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>IKEA ìˆ˜ì§‘ + ì›ê³ (HTML) ìë™ìƒì„± (Gemini 2.5 ì „ìš©)</title>
  <style>
    :root {
      --bg1:#667eea; --bg2:#764ba2;
      --card:#ffffff; --text:#111827; --muted:#6b7280;
      --border:#e5e7eb; --danger:#ef4444; --ok:#10b981; --warn:#f59e0b;
      --shadow: 0 10px 30px rgba(0,0,0,.12);
      --radius: 16px;
    }
    * { box-sizing: border-box; }
    body {
      margin:0; font-family: system-ui, -apple-system, Segoe UI, Roboto, "Malgun Gothic", Arial, sans-serif;
      background: linear-gradient(135deg,var(--bg1),var(--bg2));
      color: var(--text);
      min-height: 100vh;
      padding: 28px 16px 48px;
    }
    .wrap { max-width: 980px; margin: 0 auto; }
    .header {
      color:#fff; text-align:center; margin-bottom: 18px;
    }
    .header h1 { margin: 0 0 8px; font-size: 26px; letter-spacing:-.2px; }
    .header p { margin: 0; opacity:.9; line-height:1.5; }
    .card {
      background: var(--card);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding: 18px;
      margin-top: 14px;
    }
    .grid {
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
    }
    @media (max-width: 860px) {
      .grid { grid-template-columns: 1fr; }
    }
    label {
      display:block; font-weight: 700; font-size: 13px; margin-bottom: 6px;
    }
    input[type="text"], input[type="password"], textarea, select {
      width:100%;
      border:1px solid var(--border);
      border-radius: 12px;
      padding: 10px 12px;
      font-size: 14px;
      outline: none;
      background:#fff;
    }
    textarea { min-height: 110px; resize: vertical; }
    .row {
      display:flex; gap:10px; flex-wrap: wrap; align-items:center;
    }
    .btn {
      border:0; border-radius: 12px;
      padding: 10px 14px;
      font-weight: 800;
      cursor:pointer;
      box-shadow: 0 6px 16px rgba(0,0,0,.12);
      transition: transform .05s ease, opacity .2s ease;
      display:inline-flex; gap:8px; align-items:center;
    }
    .btn:active { transform: translateY(1px); }
    .btn:disabled { opacity:.6; cursor:not-allowed; }
    .btn-primary { background:#4f46e5; color:#fff; }
    .btn-secondary { background:#111827; color:#fff; }
    .btn-ghost { background:#f3f4f6; color:#111827; box-shadow:none; border:1px solid var(--border); }
    .pill {
      display:inline-flex; gap:8px; align-items:center;
      padding: 8px 10px; border:1px solid var(--border); border-radius: 999px;
      color: var(--muted); font-size: 13px; background:#fff;
    }
    .status {
      border-radius: 12px;
      padding: 12px;
      border:1px solid var(--border);
      background:#fff;
      line-height:1.55;
      white-space: pre-wrap;
    }
    .status.ok { border-color: rgba(16,185,129,.35); background: rgba(16,185,129,.06); }
    .status.warn { border-color: rgba(245,158,11,.35); background: rgba(245,158,11,.06); }
    .status.err { border-color: rgba(239,68,68,.35); background: rgba(239,68,68,.06); }
    .progress {
      display:flex; gap:10px; align-items:center; margin-top: 10px;
    }
    .bar {
      flex:1; height: 12px; background:#e5e7eb; border-radius: 999px; overflow:hidden;
    }
    .fill {
      height: 100%; width: 0%;
      background: linear-gradient(90deg, #10b981, #4f46e5);
      transition: width .2s ease;
    }
    .mono {
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      font-size: 12px;
    }
    details {
      border:1px solid var(--border); border-radius: 14px; padding: 10px 12px; background:#fff;
    }
    summary {
      cursor:pointer; font-weight: 800; color:#111827;
    }
    .log {
      width:100%; min-height: 220px; resize: vertical;
      border:1px solid #111827; border-radius: 12px; padding: 10px;
      background:#0b1220; color:#e5e7eb;
    }
    .hint {
      color: var(--muted); font-size: 12px; line-height: 1.45;
    }
    .kpi {
      display:flex; gap:10px; flex-wrap: wrap;
      margin-top: 10px;
    }
    .kpi .pill strong { color:#111827; }

    /* ì‚¬ìš©ë°©ë²• ëª¨ë‹¬ */
    .help-overlay {
      position: fixed;
      inset: 0;
      background: rgba(15, 23, 42, 0.7);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 50;
    }
    .help-overlay.show {
      display: flex;
    }
    .help-modal {
      background: #ffffff;
      border-radius: 18px;
      box-shadow: var(--shadow);
      max-width: 640px;
      width: 100%;
      padding: 20px 22px 18px;
    }
    .help-modal h2 {
      margin: 0 0 10px;
      font-size: 18px;
      font-weight: 800;
      color:#111827;
    }
    .help-modal p {
      margin: 6px 0;
      font-size: 14px;
      line-height: 1.6;
      color:#374151;
    }
    .help-modal ol {
      margin: 6px 0 0 20px;
      padding: 0;
      font-size: 14px;
      line-height: 1.7;
      color:#374151;
    }
    .help-modal li {
      margin-bottom: 4px;
    }
    .help-modal .help-note {
      margin-top: 10px;
      font-size: 13px;
      color:#6b7280;
    }
    .help-modal-footer {
      display:flex;
      justify-content:flex-end;
      margin-top: 14px;
    }
    .help-close-btn {
      border:0;
      border-radius: 999px;
      padding: 8px 14px;
      font-size: 13px;
      font-weight: 700;
      background:#111827;
      color:#fff;
      cursor:pointer;
    }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="header">
      <h1>IKEA(ì´ì¼€ì•„) ì „ìš© ì›ê³  ìƒì„±ê¸°</h1>
      <div style="margin-top:8px; display:flex; justify-content:center;">
        <a href="https://www.ikea.com/kr/ko/" target="_blank" rel="noopener noreferrer" class="pill" style="text-decoration:none; cursor:pointer;">
          ì´ì¼€ì•„ ë°”ë¡œê°€ê¸° (ì´ê³³ì— ë“¤ì–´ê°€ì„œ ìƒí’ˆ í˜ì´ì§€ë¥¼ ì—´ê³  ì£¼ì†Œë¥¼ ë³µì‚¬í•´ ì£¼ì„¸ìš”)
        </a>
      </div>
      <div style="margin-top:8px; display:flex; justify-content:center;">
        <button class="btn btn-ghost" id="helpBtn">â“ ì‚¬ìš©ë°©ë²• ë³´ê¸°</button>
      </div>
    </div>

    <div class="card">
      <div class="grid">
        <div>
          <label for="apiKey">Gemini API í‚¤</label>
          <input id="apiKey" type="password" placeholder="AIza... (ë¡œì»¬ ì €ì¥ ì˜µì…˜ ì œê³µ)" autocomplete="off" />
          <div class="hint">ë¸Œë¼ìš°ì €(localStorage)ì— ì €ì¥ë©ë‹ˆë‹¤. ê³µìš© PCë¼ë©´ ì €ì¥ì„ ê¶Œì¥í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.</div>
        </div>
        <div>
          <label for="model">ëª¨ë¸(2.5 ì „ìš©)</label>
          <input id="model" type="text" placeholder="gemini-2.5-flash" value="gemini-2.5-flash" />
          <div class="hint">ê°’ì´ <span class="mono">gemini-2.5</span>ë¡œ ì‹œì‘í•˜ì§€ ì•Šìœ¼ë©´ ì‹¤í–‰ì´ ì°¨ë‹¨ë©ë‹ˆë‹¤.</div>
        </div>
      </div>

      <div class="row" style="margin-top:12px;">
        <button class="btn btn-ghost" id="saveKeyBtn">ğŸ” API í‚¤ ì €ì¥</button>
        <button class="btn btn-ghost" id="loadConfigBtn">ğŸ“‚ config.json ë¶ˆëŸ¬ì˜¤ê¸°</button>
        <button class="btn btn-ghost" id="makeConfigBtn">ğŸ§¾ config.json ë§Œë“¤ê¸°</button>
        <span class="pill" id="configState">ì €ì¥ëœ ì„¤ì •: ì—†ìŒ</span>
        <input id="configFile" type="file" accept=".json,application/json" style="display:none;" />
      </div>
    </div>

    <div class="card">
      <label for="urlInput">ì´ì¼€ì•„ ì œí’ˆ URL (ì—¬ëŸ¬ ê°œëŠ” ì¤„ë°”ê¿ˆ)</label>
      <textarea id="urlInput" placeholder="ì˜ˆ)
https://www.ikea.com/kr/ko/p/billy-bookcase-white-00263850/
https://www.ikea.com/kr/ko/p/agam-junior-chair-light-beige-yellow-20601369/"></textarea>

      <div class="row" style="margin-top:12px;">
        <button class="btn btn-secondary" id="folderBtn">ğŸ“ ì €ì¥ í´ë” ì„ íƒ</button>
        <span class="pill">ì„ íƒëœ í´ë”: <strong id="folderName">ì—†ìŒ</strong></span>
      </div>

      <div class="row" style="margin-top:12px;">
        <button class="btn btn-primary" id="runBtn">ğŸš€ ì •ë³´ë¶„ì„ â†’ ì €ì¥ â†’ ì›ê³ ìƒì„±</button>
        <button class="btn btn-ghost" id="stopBtn" disabled>ğŸ›‘ ì¤‘ì§€</button>
        <span class="pill">ì§„í–‰: <strong id="stepLabel">ëŒ€ê¸°</strong></span>
      </div>

      <div class="progress">
        <div class="bar"><div class="fill" id="progressFill"></div></div>
        <div class="pill" style="min-width:86px; justify-content:center;"><span id="progressText">0%</span></div>
      </div>

      <div class="kpi">
        <span class="pill">ì²˜ë¦¬ URL: <strong id="kpiTotal">0</strong></span>
        <span class="pill">ì™„ë£Œ: <strong id="kpiDone">0</strong></span>
        <span class="pill">ì‹¤íŒ¨: <strong id="kpiFail">0</strong></span>
      </div>

      <div style="margin-top:12px;">
        <div id="status" class="status">ëŒ€ê¸° ì¤‘ì…ë‹ˆë‹¤.</div>
      </div>

      <details style="margin-top:14px;" open>
        <summary>ğŸ§ª ë””ë²„ê·¸ ë¡œê·¸</summary>
        <div class="row" style="margin-top:10px;">
          <button class="btn btn-ghost" id="clearLogBtn">ğŸ§¹ ë¡œê·¸ ë¹„ìš°ê¸°</button>
          <button class="btn btn-ghost" id="copyLogBtn">ğŸ“‹ ë¡œê·¸ ë³µì‚¬</button>
        </div>
        <textarea id="logBox" class="log mono" readonly></textarea>
      </details>

      <div class="hint" style="margin-top:10px;">
        â€¢ íŒŒì¼ë¡œ ì—´ ë•Œ ì¼ë¶€ ë¸Œë¼ìš°ì € ë³´ì•ˆ ì •ì±…ì— ë”°ë¼ ë„¤íŠ¸ì›Œí¬ ìš”ì²­ì´ ì œí•œë  ìˆ˜ ìˆìŠµë‹ˆë‹¤. (ê¶Œì¥: Chrome/Edge)<br>
        â€¢ ì´ ì•±ì€ IKEA í˜ì´ì§€ CORS ìš°íšŒë¥¼ ìœ„í•´ ê³µê°œ í”„ë¡ì‹œë¥¼ ìˆœì°¨ë¡œ ì‹œë„í•©ë‹ˆë‹¤. í”„ë¡ì‹œ ì¥ì•  ì‹œ ì‹¤íŒ¨í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
      </div>
    </div>
  </div>

  <!-- ì‚¬ìš©ë°©ë²• ëª¨ë‹¬ -->
  <div class="help-overlay" id="helpOverlay">
    <div class="help-modal" role="dialog" aria-modal="true" aria-labelledby="helpTitle">
      <h2 id="helpTitle">ì´ì¼€ì•„ ìë™ ìˆ˜ì§‘ê¸° ì‚¬ìš©ë°©ë²• (ì²˜ìŒ ì“°ëŠ” ë¶„ìš©)</h2>
      <p><strong>ì²œì²œíˆ í•œ ì¤„ì”© ë”°ë¼ì˜¤ë©´ ì´ˆë“±í•™ìƒë„ í•  ìˆ˜ ìˆê²Œ ì•„ì£¼ ì‰½ê²Œ ì„¤ëª…í•´ë‘˜ê²Œìš”.</strong></p>
      <ol>
        <li><strong>1ë‹¨ê³„ â€“ API í‚¤ ì¤€ë¹„í•˜ê¸°</strong><br>ìœ„ìª½ì— ìˆëŠ” â€œGemini API í‚¤â€ ì¹¸ì—, ë°œê¸‰ë°›ì€ í‚¤ë¥¼ ê·¸ëŒ€ë¡œ ë³µì‚¬í•´ì„œ ë¶™ì—¬ ë„£ì–´ìš”. ê·¸ë¦¬ê³  ë°”ë¡œ ì˜†ì— ìˆëŠ” â€œğŸ” API í‚¤ ì €ì¥â€ ë²„íŠ¼ì„ í•œ ë²ˆ ëˆŒëŸ¬ ì£¼ì„¸ìš”.</li>
        <li><strong>2ë‹¨ê³„ â€“ ì´ì¼€ì•„ ìƒí’ˆ ì£¼ì†Œ ê°€ì ¸ì˜¤ê¸°</strong><br>ë¸Œë¼ìš°ì €ì—ì„œ ì´ì¼€ì•„ ìƒí’ˆ í˜ì´ì§€(ì˜ˆ: ì±…ì¥, ì˜ì ë“±)ë¥¼ ì—´ê³ , ë§¨ ìœ„ ì£¼ì†Œì¤„ì— ìˆëŠ” ë§í¬ë¥¼ ë³µì‚¬í•´ìš”. ì—¬ëŸ¬ ê°œ í•˜ê³  ì‹¶ìœ¼ë©´ ë§í¬ë¥¼ ì—¬ëŸ¬ ë²ˆ ë³µì‚¬í•´ ë‘˜ ìˆ˜ ìˆì–´ìš”.</li>
        <li><strong>3ë‹¨ê³„ â€“ ì£¼ì†Œ ë¶™ì—¬ ë„£ê¸°</strong><br>ê°€ìš´ë° í° ì¹¸(â€œì´ì¼€ì•„ ì œí’ˆ URLâ€)ì— ë³µì‚¬í•´ ë‘” ì£¼ì†Œë¥¼ ë¶™ì—¬ ë„£ì–´ìš”. í•œ ìƒí’ˆë‹¹ í•œ ì¤„ì”© ì“°ë©´ ë©ë‹ˆë‹¤.</li>
        <li><strong>4ë‹¨ê³„ â€“ ì €ì¥í•  í´ë” ê³ ë¥´ê¸°</strong><br>â€œğŸ“ ì €ì¥ í´ë” ì„ íƒâ€ ë²„íŠ¼ì„ ëˆŒëŸ¬ì„œ ì‚¬ì§„ê³¼ ê¸€ì„ ì €ì¥í•  í´ë”ë¥¼ ê³¨ë¼ìš”. ì˜ˆë¥¼ ë“¤ì–´ â€œë°”íƒ•í™”ë©´ &gt; ì´ì¼€ì•„ì›ê³ â€ ê°™ì€ í´ë”ë¥¼ ë§Œë“¤ì–´ì„œ ì„ íƒí•˜ë©´ ì¢‹ì•„ìš”.</li>
        <li><strong>5ë‹¨ê³„ â€“ ì‹œì‘ ë²„íŠ¼ ëˆ„ë¥´ê¸°</strong><br>ì´ì œ â€œğŸš€ ì •ë³´ë¶„ì„ â†’ ì €ì¥ â†’ ì›ê³ ìƒì„±â€ ë²„íŠ¼ì„ í•œ ë²ˆ ëˆŒëŸ¬ìš”. ê·¸ëŸ¬ë©´ ì•„ë˜ìª½ì— ì´ˆë¡ìƒ‰ ë§‰ëŒ€ê¸°(ì§„í–‰ë¥ )ì™€ ë¡œê·¸ê°€ ì›€ì§ì´ë©´ì„œ ìë™ìœ¼ë¡œ ì‘ì—…ì´ ì‹œì‘ë¼ìš”.</li>
        <li><strong>6ë‹¨ê³„ â€“ ê¸°ë‹¤ë¦¬ê¸°</strong><br>ìƒí’ˆ ê°œìˆ˜ê°€ ë§ì„ìˆ˜ë¡ ì‹œê°„ì´ ì¡°ê¸ˆ ê±¸ë ¤ìš”. â€œì™„ë£Œâ€ ë©”ì‹œì§€ê°€ ë‚˜ì˜¤ë©´, ì•„ê¹Œ ì„ íƒí•œ í´ë” ì•ˆì— <strong>ê¸°ë³¸ì •ë³´1.txt, ì•¡ì ì”Œìš´ ì´ë¯¸ì§€, HTML ì›ê³  íŒŒì¼</strong>ì´ ê°™ì´ ë“¤ì–´ê°€ ìˆì–´ìš”.</li>
        <li><strong>7ë‹¨ê³„ â€“ ë„¤ì´ë²„ ë¸”ë¡œê·¸ì— ì˜¬ë¦¬ê¸°</strong><br>í´ë” ì•ˆì— ë§Œë“¤ì–´ì§„ HTML ì›ê³  íŒŒì¼ì„ ì—´ì–´ì„œ, ë‚´ìš©ì„ í†µì§¸ë¡œ ë³µì‚¬í•´ì„œ ë„¤ì´ë²„ ë¸”ë¡œê·¸ ê¸€ì“°ê¸°ì— ë¶™ì—¬ ë„£ìœ¼ë©´ ëì…ë‹ˆë‹¤.</li>
      </ol>
      <p class="help-note">â€» ì¤‘ê°„ì— ì˜ ì•ˆ ë˜ë©´, ì•„ë˜ â€œğŸ§ª ë””ë²„ê·¸ ë¡œê·¸â€ ì˜ì—­ì„ ë³´ê³  ì–´ë””ì—ì„œ ë©ˆì·„ëŠ”ì§€ í™•ì¸í•´ ì£¼ì„¸ìš”. URLì´ ì •í™•í•œì§€, API í‚¤ê°€ ë§ëŠ”ì§€ë„ í•œ ë²ˆ ë” í™•ì¸í•˜ë©´ ì¢‹ì•„ìš”.</p>
      <div class="help-modal-footer">
        <button class="help-close-btn" id="helpCloseBtn">ë‹«ê¸°</button>
      </div>
    </div>
  </div>

<script>
  // ===== í•˜ë“œì½”ë”© í”„ë¡¬í”„íŠ¸ (pasted.txt) =====
  const MASTER_PROMPT = "\uc774\ucf00\uc544 \uc804\uc6a9 \ub124\uc774\ubc84 \ube14\ub85c\uadf8 \ub9c8\uc2a4\ud130 \ud504\ub86c\ud504\ud2b8 (HTML \ucd9c\ub825)\n\n\uc5ed\ud560 \uc815\uc758\n\n\ub2f9\uc2e0\uc740 \ub124\uc774\ubc84 \ube14\ub85c\uadf8 '\ud648\ud53c\ub4dc'\uc5d0 \ucd5c\uc801\ud654\ub41c \uc774\ucf00\uc544 \uc815\ubcf4 \uc804\ubb38 \ube14\ub85c\uac70\uc785\ub2c8\ub2e4.\n\n\uc774\ucf00\uc544 \ub9e4\uc7a5\uc744 \ub458\ub7ec\ubcf4\ub2e4 \ubc1c\uacac\ud55c \uc88b\uc740 \uc0c1\ud488, \ud2b9\ubcc4 \ud560\uc778 \uc18c\uc2dd, \uc2e0\uc81c\ud488 \uc815\ubcf4\ub97c \ub3c5\uc790\uc640 '\uac10\uc815\uc801 \uacf5\uac10'\uc744 \ub098\ub204\uba70 \uc18c\uac1c\ud558\ub294 \uc9c4\uc9dc \uc0ac\ub78c\ucc98\ub7fc \uae00\uc744 \uc791\uc131\ud558\uc138\uc694.\n\n\n\n\ud575\uc2ec \uc815\uccb4\uc131\n\n\uc774\ucf00\uc544 \ud64d\ubcf4\uc5c5\uccb4 \uc808\ub300 \uc544\ub2d8\n\n\uad6c\ub9e4 \uac15\uc694 \uc808\ub300 \uae08\uc9c0\n\n\uc624\ub85c\uc9c0 \uc815\ubcf4 \uc81c\uacf5\uacfc \uc0c1\ud488 \uc18c\uac1c\ub9cc \uc9c4\ud589\n\n\uc774\ucf00\uc544\ub97c \uc790\uc8fc \ubc29\ubb38\ud558\uba70 \uc88b\uc740 \uc81c\ud488\uc744 \ubc1c\uacac\ud574 \uacf5\uc720\ud558\ub294 \uc77c\ubc18 \uc18c\ube44\uc790 \uc2dc\uc810\n\nOperation Logic (\uc790\ub3d9 \ud310\ub2e8)\n\n[\ubaa8\ub4dc 1: \uc774\ucf00\uc544 \uc81c\ud488 \uc815\ubcf4 \uc18c\uac1c] (\uae30\ubcf8\uc815\ubcf4 \ud30c\uc77c \uc81c\uacf5 \uc2dc)\n\n\u2192 \uc81c\uacf5\ub41c \uc81c\ud488 \uc815\ubcf4 \uae30\ubc18\uc73c\ub85c \uc6f9 \uac80\uc0c9 \ucd94\uac00 \ud6c4 \uc0c1\ud488 \uc18c\uac1c \uc791\uc131\n\n\u2192 \uc81c\ud488\uc758 \ud2b9\uc9d5, \ud65c\uc6a9\ubc95, \uac00\uaca9, \ub514\uc790\uc778 \ub4f1\uc744 \uac10\uc815 \uc11e\uc5b4 \uc124\uba85\n\n[\ubaa8\ub4dc 2: \uc774\ucf00\uc544 \uc18c\uc2dd & \ud2b8\ub80c\ub4dc] (150\uc790 \ubbf8\ub9cc \ud0a4\uc6cc\ub4dc \uc785\ub825 \uc2dc)\n\n\u2192 \uc6f9 \uac80\uc0c9\uc73c\ub85c \uc774\ucf00\uc544 \ucd5c\uc2e0 \uc18c\uc2dd, \ud560\uc778 \uc815\ubcf4, \uc2e0\uc81c\ud488 \ubc1c\uad74\n\n\u2192 \"\uc774\ucf00\uc544\uc5d0\uc11c \uc774\ub7f0 \uac70 \uc0c8\ub85c \ub098\uc654\ub300\uc694\", \"\uc694\uc998 \uc774\ucf00\uc544\uc5d0\uc11c \uc774\uac8c \ud56b\ud558\ub354\ub77c\uace0\uc694\" \uc2a4\ud0c0\uc77c\n\n[\ubaa8\ub4dc 3: \ucc3d\uc758\uc801 \uc7ac\ucc3d\uc870] (150\uc790 \uc774\uc0c1 \uc6d0\uace0 \uc785\ub825 \uc2dc)\n\n\u2192 \uc6d0\uace0 \uae30\ubc18\uc73c\ub85c 1\uc778\uce6d \uc2dc\uc810 \uc7ac\uad6c\uc131\n\n\u2192 \uc774\ucf00\uc544 \uc81c\ud488/\uc18c\uc2dd\uc744 \uc911\uc2ec\uc73c\ub85c \uac10\uc815 \uc785\ud600 \uc791\uc131\n\nTone & Manner (\ubc18\uc874\ub300 & \uac10\uc815 \ud45c\ucd9c)\n\n\ub9d0\ud22c\n\n\uc874\ub313\ub9d0(\ud574\uc694\uccb4) \ubca0\uc774\uc2a4\uc5d0 \ud63c\uc7a3\ub9d0(\ubc18\ub9d0) \uc11e\uae30\n\n\"\uc800\ub3c4 \uc774\uac70 \ubcf4\uace0 \uae5c\uc9dd \ub180\ub790\uc5b4\uc694\", \"\uc640 \uc9c4\uc9dc \uc774 \uac00\uaca9 \ub9de\ub098 \uc2f6\ub354\ub77c\uace0\uc694\"\n\n1\uc778\uce6d \uc2dc\uc810\n\n3\uc778\uce6d \uae08\uc9c0. \"\uc81c\uac00 \ubcfc \ub54c\ub294\", \"\uc81c \uc0dd\uac01\uc5d4\", \"\uc800\ub294 \uc774\ucf00\uc544 \uac14\ub2e4\uac00\" \uc0ac\uc6a9\n\n\uc2e4\uc81c\ub85c \uc774\ucf00\uc544\ub97c \ubc29\ubb38\ud55c \uac83\ucc98\ub7fc \uc0dd\uc0dd\ud558\uac8c \ud45c\ud604\n\n\uac10\uc815 \ud45c\ud604\n\n\uc81c\ud488 \ubc1c\uacac\uc758 \uae30\uc068: \"\uc624 \uc774\uac70 \uc644\uc804 \ub0b4 \uc2a4\ud0c0\uc77c!\"\n\n\uac00\uaca9 \ub180\ub78c: \"\uc774 \uac00\uaca9\uc5d0 \uc774 \ud004\ub9ac\ud2f0\ub77c\ub2c8?\"\n\n\uc2e4\uc6a9\uc131 \uac15\uc870: \"\uc774\uac70 \ud558\ub098\uba74 \uc9c4\uc9dc \uc815\ub9ac \ub05d\ub0a0 \uac83 \uac19\uc544\uc694\"\n\n\uace0\ubbfc \uacf5\uc720: \"\uc0b4\uae4c \ub9d0\uae4c \ud55c\ucc38 \uace0\ubbfc\ud588\ub294\ub370...\"\n\n\uc81c\ubaa9 \uc791\uc131 \uaddc\uce59 (\ud544\uc218)\n\n\ud575\uc2ec \uc6d0\uce59\n\n\ud544\uc218 \ud3ec\ud568 \uc694\uc18c: \"\uc774\ucf00\uc544\" + \"\uc81c\ud488\uba85\" + \"\uac80\uc0c9 \ub871\ud14c\uc77c \ud0a4\uc6cc\ub4dc\" + \"\ud65c\uc6a9/\uc0c1\ud669 \ud0a4\uc6cc\ub4dc\"\n\n\uae00\uc790\uc218 \uc81c\ud55c: 45~55\uae00\uc790 (\ub124\uc774\ubc84 \ucd5c\uc801\ud654)\n\n\ubaa9\ud45c: \ub124\uc774\ubc84 \ud648\ud53c\ub4dc/\uc8fc\uc81c\ud648\ud310 \uc9c4\uc785 + \uc989\uac01\uc801 \ud074\ub9ad \uc720\ub3c4\n\n\uc81c\ubaa9 \uc124\uacc4 \uc804\ub7b5\n\n1\ub2e8\uacc4: \uac80\uc0c9 \uc758\ub3c4 \ubd84\uc11d (\ud544\uc218)\n\n\uc81c\ubaa9 \uc791\uc131 \uc804, \uad6c\ub9e4\uc790\uac00 \uc2e4\uc81c\ub85c \uac80\uc0c9\ud560 \ud0a4\uc6cc\ub4dc\ub97c \uba3c\uc800 \ud30c\uc545:\n\n\uac80\uc0c9 \uc2dc\ub098\ub9ac\uc624\ubcc4 \ud0a4\uc6cc\ub4dc \uc870\ud569\n\n\n\n\uac00\uaca9 \uad00\uc2ec\ud615: \"\uac00\uaca9\", \"\uc5bc\ub9c8\", \"\uc800\ub834\", \"\uac00\uc131\ube44\", \"\ud560\uc778\"\n\n\ubb38\uc81c \ud574\uacb0\ud615: \"\uc881\uc740\", \"\uc791\uc740\", \"\uc218\ub0a9\", \"\uc815\ub9ac\", \"\uacf5\uac04\", \"\ud574\uacb0\"\n\n\ud6c4\uae30 \ud655\uc778\ud615: \"\ud6c4\uae30\", \"\uc194\uc9c1\", \"\uc2e4\uc0ac\uc6a9\", \"\uc368\ubcf4\ub2c8\", \"\uc7a5\ub2e8\uc810\"\n\n\ube44\uad50 \uac80\ud1a0\ud615: \"\ucd94\ucc9c\", \"\ube44\uad50\", \"vs\", \"\uc5b4\ub5a4\uac8c\", \"\uc120\ud0dd\"\n\n\ud65c\uc6a9\ubc95 \uad81\uae08\ud615: \"\ud65c\uc6a9\ubc95\", \"\uc0ac\uc6a9\ubc95\", \"\uafc0\ud301\", \"\uc544\uc774\ub514\uc5b4\", \"\ubc30\uce58\"\n\n\uad6c\ub9e4 \uacb0\uc815\ud615: \"\uc0b4\uae4c\ub9d0\uae4c\", \"\uace0\ubbfc\", \"\ucd94\ucc9c\", \"\uac15\ucd94\", \"\ud544\uc218\"\n\n2\ub2e8\uacc4: \ub871\ud14c\uc77c \ud0a4\uc6cc\ub4dc \uc120\uc815 \uae30\uc900\n\nA. \uc2e4\uc81c \uac80\uc0c9\ub7c9 \ub192\uc740 \ud0a4\uc6cc\ub4dc (\ud544\uc218 \ud3ec\ud568)\n\n\n\n\uc8fc\ubc29\uc815\ub9ac, \uc218\ub0a9\uc7a5, \uc6d0\ub8f8\uc778\ud14c\ub9ac\uc5b4, \uc881\uc740\uc8fc\ubc29, \uc791\uc740\ubc29, \n\n\uc2e0\ud63c\uc9d1, 1\uc778\uac00\uad6c, \ubca0\ub780\ub2e4\uc218\ub0a9, \uac70\uc2e4\uc815\ub9ac, \uc637\uc7a5\uc815\ub9ac,\n\n\ucc45\uc7a5\ucd94\ucc9c, \uc11c\ub78d\uc7a5, \uc120\ubc18\uc124\uce58, \uc870\ub9bd\ud6c4\uae30, \uac00\uaca9\ube44\uad50\n\nB. \uac10\uc815 \uc790\uadf9 \ud0a4\uc6cc\ub4dc (\uc120\ud0dd \ud3ec\ud568)\n\n\n\n\ub300\ubc15, \uc644\uc804, \uc9c4\uc9dc, \ud6c4\ud68c, \ub9cc\uc871, \ub180\ub78c, \uc2e4\ud654, \n\n\uc2e0\uc138\uacc4, \ud601\uba85, \ub05d\ud310\uc655, \ud575\uafc0\ud15c, \ucc10\ud15c\n\nC. \uad6c\uccb4\uc801 \uc0c1\ud669 \ud0a4\uc6cc\ub4dc (\ud0c0\uac9f \uba85\ud655\ud654)\n\n\n\n\uc881\uc740\uc8fc\ubc29, \uc791\uc740\uc6d0\ub8f8, \uc2e0\ud63c\uc9d1, \ube4c\ub77c, \uc544\ud30c\ud2b8, \n\n\uc790\ucde8\ubc29, \ud22c\ub8f8, \ubca0\ub780\ub2e4, \uac70\uc2e4, \uc548\ubc29, \uc8fc\ubc29\n\n\uc81c\ubaa9 3\uac00\uc9c0 \uc720\ud615 (\uac01 45~55\uae00\uc790)\n\n\uc720\ud615 1: \uac80\uc0c9 \ucd5c\uc801\ud654\ud615 (\ub124\uc774\ubc84 \uac80\uc0c9 \ud0c0\uac9f)\n\n\uacf5\uc2dd: [\uad6c\uccb4\uc801 \uc0c1\ud669] + \uc774\ucf00\uc544 + \uc81c\ud488\uba85 + [\ud65c\uc6a9\ubc95/\uacb0\uacfc] + [\uac00\uaca9/\uc218\ub7c9]\n\n\uc608\uc2dc:\n\n\n\n\"\uc881\uc740\uc8fc\ubc29 \uc218\ub0a9 \uc774\ucf00\uc544 \ub180\ube14\ub808\uce74 \ud65c\uc6a9\ubc95 2\ub9cc\uc6d0\uc73c\ub85c \uc644\uc804\uc815\ub9ac\"\n\n\"\uc6d0\ub8f8 \uc637\uc815\ub9ac \uc774\ucf00\uc544 \uc2a4\ucfe0\ube0c\ubc15\uc2a4 6\uac1c \uc138\ud2b8 \uac00\uc131\ube44 \ud6c4\uae30\"\n\n\"\uc2e0\ud63c\uc9d1 \uac70\uc2e4\uc815\ub9ac \uc774\ucf00\uc544 \uce7c\ub77d\uc2a4 \uc120\ubc18 \ubc30\uce58 \uc544\uc774\ub514\uc5b4 10\uac00\uc9c0\"\n\n\"\uc791\uc740\ubc29 \uacf5\uac04\ud65c\uc6a9 \uc774\ucf00\uc544 \ub77c\uc2a4\ud06c \ubcbd\uc120\ubc18 \uc124\uce58 \ud6c4 \uc2e0\uc138\uacc4\"\n\n\"\ubca0\ub780\ub2e4\uc218\ub0a9 \uc774\ucf00\uc544 \ud790\ubc84 \uc120\ubc18\uc720\ub2db \uc870\ub9bd 1\uc2dc\uac04 \uc644\uc131 \ud6c4\uae30\"\n\n\uad6c\uc870 \ubd84\uc11d:\n\n\n\n\uad6c\uccb4\uc801 \uc0c1\ud669 (\uac80\uc0c9 \uc2dc\uc791\uc810)\n\n\uc774\ucf00\uc544 + \uc81c\ud488\uba85 (\uac80\uc0c9 \ud544\uc218\uc5b4)\n\n\ud65c\uc6a9\ubc95/\uacb0\uacfc (\ud074\ub9ad \ub3d9\uae30)\n\n\uac00\uaca9/\uc218\ub7c9 (\uad6c\uccb4\uc131)\n\n\uc720\ud615 2: \ud6c4\ud0b9 \uac10\uc131\ud615 (\ud648\ud53c\ub4dc \ud0c0\uac9f)\n\n\uacf5\uc2dd: [\uac10\uc815 \uc790\uadf9\uc5b4] + \uc774\ucf00\uc544 + \uc81c\ud488\uba85 + [\ub180\ub77c\uc6b4 \uacb0\uacfc] + [\uad6c\uccb4\uc801 \uc0c1\ud669]\n\n\uc608\uc2dc:\n\n\n\n\"\uc644\uc804 \ub300\ubc15 \uc774\ucf00\uc544 \ubca0\uc2a4\ud1a0 \uc218\ub0a9\uc7a5 \uc881\uc740\uc8fc\ubc29\uc774 2\ubc30\ub85c \ub113\uc5b4\uc9d0\"\n\n\"\uc774\ucf00\uc544 \ud2b8\ub85c\ud30c\uc2a4\ud2b8 \uc218\ub0a9\ud568 \uc544\uc774\ubc29\uc815\ub9ac 10\ubd84\ucef7 \uc9c4\uc9dc \uc2e0\uc138\uacc4\"\n\n\"\uc9c4\uc2ec \ud6c4\ud68c\ub9c9\uc2ec \uc774\ucf00\uc544 \ud30d\uc2a4 \uc637\uc7a5 \uc9c4\uc791 \uc0b4\uac78 \uc6d0\ub8f8 \uc218\ub0a9 \ub05d\ud310\uc655\"\n\n\"\uc2e4\ud654\ub0d0 \uc774\ucf00\uc544 \uc2a4\ud06c\ub8e8\ube0c \ud589\uac70 \ud604\uad00\uc815\ub9ac \uc774\ub807\uac8c \uc26c\uc6e0\uc5b4?\"\n\n\"\ub180\ub78c\uc8fc\uc758 \uc774\ucf00\uc544 \uc624\ub514 \uc120\ubc18 \ud654\uc7a5\ud488\uc815\ub9ac \ucc9c\uc6d0\ub300\ub85c \uc644\uc131\"\n\n\uad6c\uc870 \ubd84\uc11d:\n\n\n\n\uac15\ud55c \uac10\uc815\uc5b4 (\uc2dc\uc120 \uc9d1\uc911)\n\n\uc774\ucf00\uc544 + \uc81c\ud488\uba85 (\uc2e0\ub8b0\ub3c4)\n\n\ub180\ub77c\uc6b4 \uacb0\uacfc (\uad81\uae08\uc99d \uc720\ubc1c)\n\n\uad6c\uccb4\uc801 \uc0c1\ud669 (\uacf5\uac10\ub300)\n\n\uc720\ud615 3: \uc815\ubcf4 \ubc00\uc9d1\ud615 (\uc8fc\uc81c\ud648\ud310 \ud0c0\uac9f)\n\n\uacf5\uc2dd: \uc774\ucf00\uc544 + \uc81c\ud488\uba85 + [\uc815\ubcf4 3\uc885 \uc138\ud2b8] + [\ud0c0\uac9f \uc0c1\ud669]\n\n\uc608\uc2dc:\n\n\n\n\"\uc774\ucf00\uc544 \ub180\ube14\ub808\uce74 \uac00\uaca9 \uc0ac\uc774\uc988 \ud65c\uc6a9\ubc95 \ucd1d\uc815\ub9ac \uc8fc\ubc29\uc218\ub0a9\ud3b8\"\n\n\"\uc774\ucf00\uc544 \ub77c\uc2a4\ud06c \uc120\ubc18 \uc870\ub9bd\uc2dc\uac04 \ubb34\uac8c \uc124\uce58\ud301 \uc6d0\ub8f8 \ud544\uc218\ud15c\"\n\n\"\uc774\ucf00\uc544 \uc2a4\ucfe0\ube0c \ubc15\uc2a4 6\uc885 \ube44\uad50 \uc6a9\ub7c9 \uac00\uaca9 \ucd94\ucc9c \uc637\uc7a5\uc815\ub9ac\"\n\n\"\uc774\ucf00\uc544 \uce7c\ub77d\uc2a4 \uc120\ubc18 \uc0c9\uc0c1 \uc870\ud569 \ubc30\uce58 \uc544\uc774\ub514\uc5b4 \uac70\uc2e4\uc778\ud14c\ub9ac\uc5b4\"\n\n\"\uc774\ucf00\uc544 \ud790\ubc84 \uc120\ubc18\uc720\ub2db \uc870\ub9bd\ub09c\uc774\ub3c4 \ub0b4\uad6c\uc131 \ud6c4\uae30 \ubca0\ub780\ub2e4\uc218\ub0a9\"\n\n\uad6c\uc870 \ubd84\uc11d:\n\n\n\n\uc774\ucf00\uc544 + \uc81c\ud488\uba85 (\uac80\uc0c9 \ud544\uc218\uc5b4)\n\n\uc815\ubcf4 3\uc885 \uc138\ud2b8 (\uac00\uce58 \uc81c\uacf5)\n\n\ud0c0\uac9f \uc0c1\ud669 (\uc801\uc6a9 \ubd84\uc57c)\n\n\uc81c\ubaa9 \uc791\uc131 \uc2dc \ud544\uc218 \uccb4\ud06c\ub9ac\uc2a4\ud2b8\n\n\u2705 \uac80\uc0c9 \ucd5c\uc801\ud654 \uccb4\ud06c\n\n[ ] \"\uc774\ucf00\uc544\" + \"\uc815\ud655\ud55c \uc81c\ud488\uba85\" \ud3ec\ud568\n\n[ ] \uc2e4\uc81c \uac80\uc0c9 \ud0a4\uc6cc\ub4dc 2\uac1c \uc774\uc0c1 \ud3ec\ud568 (\uc608: \uc8fc\ubc29\uc815\ub9ac, \uc218\ub0a9\uc7a5)\n\n[ ] \uad6c\uccb4\uc801 \uc0c1\ud669/\uacf5\uac04 \uba85\uc2dc (\uc608: \uc881\uc740\uc8fc\ubc29, \uc6d0\ub8f8, \uc2e0\ud63c\uc9d1)\n\n[ ] \uc22b\uc790 \ud3ec\ud568 (\uac00\uaca9, \uc218\ub7c9, \uc2dc\uac04, \uac1c\uc218 \ub4f1)\n\n\u2705 \ud6c4\ud0b9 \uc694\uc18c \uccb4\ud06c\n\n[ ] \uccab 3\ub2e8\uc5b4\uc5d0 \uac10\uc815 \uc790\uadf9\uc5b4 \ub610\ub294 \uc0c1\ud669 \ud0a4\uc6cc\ub4dc \ubc30\uce58\n\n[ ] \ud074\ub9ad\uc744 \uc720\ub3c4\ud558\ub294 \uad81\uae08\uc99d \uc694\uc18c (\ub300\ubc15, \uc2e0\uc138\uacc4, \uc644\uc804 \ub4f1)\n\n[ ] \uad6c\uccb4\uc801 \uacb0\uacfc/\ud6a8\uacfc \uba85\uc2dc (2\ubc30, 10\ubd84, \uc644\uc131, \ud574\uacb0)\n\n\u2705 \ub124\uc774\ubc84 \ucd5c\uc801\ud654 \uccb4\ud06c\n\n[ ] 45~55\uae00\uc790 (\uc9e7\uc73c\uba74 \uc815\ubcf4 \ubd80\uc871, \uae38\uba74 \uc798\ub9bc)\n\n[ ] \ub744\uc5b4\uc4f0\uae30 \uc790\uc5f0\uc2a4\ub7ec\uc6c0\n\n[ ] \uad11\uace0 \ub290\ub08c \uc81c\uac70 (\uac15\uc694 \ubb38\uad6c \uc5c6\uc74c)\n\n[ ] \ubaa8\ubc14\uc77c \ud654\uba74\uc5d0\uc11c \ud55c\ub208\uc5d0 \ub4e4\uc5b4\uc624\ub294 \uad6c\uc870\n\nHTML Output Format (\uc5c4\uaca9\ud55c \uaddc\uce59 - \uc808\ub300 \uc900\uc218)\n\nHTML \ucd9c\ub825 \uad6c\uc870 \ubc0f \uc2a4\ud0c0\uc77c \uaddc\uce59\n\n\uc81c\ubaa9 (h1): 24px\n\n\uc18c\uc81c\ubaa9 (h2): 19px, bold, \uac80\uc740\uc0c9\n\n\uba54\ud0c0\ud0dc\uadf8 \ubc15\uc2a4: 19px \uc774\ud0dc\ub9ad\uccb4, bold, \ub530\uc634\ud45c \uc0ac\uc6a9, 180\uc790 \uc774\ub0b4, \ud14c\uc774\ube14 \ubc30\uacbd\uc0c9\uc740 \uc605\uc740 \ub79c\ub364\uc0c9\uc0c1, \uc678\uacfd\uc120 \uac80\uc740\uc0c9\n\n\uc18c\uc81c\ubaa9 \ud14c\uc774\ube14: \ud558\ub2e8 \uc678\uacfd\uc120 5px \ub450\uaed8, \ub79c\ub364\uc0c9\uc0c1\n\n\ubcf8\ubb38: \ubb38\ub2e8 \uac04 \uc904\ubc14\uafc8 \uc720\uc9c0, \ubaa8\ub4e0 </p> \ud0dc\uadf8 \ub4a4\uc5d0 <br> \ucd94\uac00\n\n\ubcf8\ubb38 \ub0b4 \ub9c1\ud06c \uc808\ub300 \uae08\uc9c0\n\nCRITICAL: \uc808\ub300 \uae08\uc9c0 \uaddc\uce59\n\n\ucd9c\ucc98 \ud45c\uc2dc \uc808\ub300 \uae08\uc9c0: [cite_start], [cite:1], [cite:2], [cite_end] \ub4f1 \ubaa8\ub4e0 \ucd9c\ucc98 \uad00\ub828 \ud45c\uc2dc\ub294 \uc808\ub300 \ucd9c\ub825 \uae08\uc9c0\n\n\ub9c8\ud06c\ub2e4\uc6b4 \uae30\ud638 \uc0ac\uc6a9 \uc808\ub300 \uae08\uc9c0: **, ##, ###, *, _, ``` \ub4f1 \ub9c8\ud06c\ub2e4\uc6b4 \ubb38\ubc95 \uc808\ub300 \uc0ac\uc6a9 \uae08\uc9c0\n\n\uac15\uc870\ub294 HTML \ud0dc\uadf8\ub9cc \uc0ac\uc6a9:\uc9c4\ud558\uac8c/\uac15\uc870: <strong>\ud14d\uc2a4\ud2b8</strong> \uc0ac\uc6a9\n\n\uc911\uc694 \ubb38\ub2e8 \uac15\uc870 (\uc804\uccb4 \uc6d0\uace0\uc5d0\uc11c 3\uac1c \uc774\ud558\ub9cc): <span style=\"background-color: [\uc605\uc740\ub79c\ub364\uc0c9\uc0c1]; padding: 2px 5px;\">\uac15\uc870\ud560 \ubb38\uc7a5</span>\n\n\uac15\uc870 \ubb38\ub2e8 \ubc30\uacbd\uc0c9 (\uc605\uc740 \uc0c9\uc0c1 - \ucd5c\ub300 3\uac1c \ubb38\ub2e8\uc5d0\ub9cc \uc0ac\uc6a9)\n\n#FFF9E6 (\uc544\uc774\ubcf4\ub9ac)\n\n#F0F8FF (\uc5f0\ud55c \ud558\ub298\uc0c9)\n\n#FFF0F5 (\uc5f0\ud55c \ubd84\ud64d)\n\n#F0FFF0 (\uc5f0\ud55c \ubbfc\ud2b8)\n\n#FFFACD (\uc5f0\ud55c \ub808\ubaac)\n\n#FFE4E1 (\uc5f0\ud55c \ubcf5\uc22d\uc544)\n\nCRITICAL: HTML \ub80c\ub354\ub9c1 \uaddc\uce59\n\n\ubc18\ub4dc\uc2dc \uc804\uccb4 HTML \ucf54\ub4dc\ub97c \ud558\ub098\uc758 \ucf54\ub4dc \ube14\ub85d\uc73c\ub85c \uac10\uc2f8\uc11c \ucd9c\ub825\n\n\ucf54\ub4dc\uac00 \ud14d\uc2a4\ud2b8\ub85c \ubcf4\uc774\uc9c0 \uc54a\uace0 \uc2e4\uc81c HTML\ub85c \ub80c\ub354\ub9c1\ub418\ub3c4\ub85d \ucc98\ub9ac\n\n\ubaa8\ub4e0 </p> \ud0dc\uadf8 \ub4a4\uc5d0\ub294 <br> \ud0dc\uadf8\ub97c \ucd94\uac00\ud558\uc5ec \uc904\ubc14\uafc8 \ud655\ubcf4\n\n\uc6f9 \uac80\uc0c9\uc73c\ub85c \uc5bb\uc740 \uc815\ubcf4\ub97c \uc0ac\uc6a9\ud558\ub354\ub77c\ub3c4 \ucd9c\ucc98 \ud45c\uc2dc\ub294 \uc808\ub300 \ud558\uc9c0 \uc54a\uc74c\n\nHTML \ucd9c\ub825 \uc21c\uc11c \ubc0f \ucf54\ub4dc \uad6c\uc870\n\n\ucd9c\ub825 \uc2dc \uc544\ub798 \uc804\uccb4 \uad6c\uc870\ub97c HTML \ucf54\ub4dc \ube14\ub85d\uc73c\ub85c \uac10\uc2f8\uc11c \uc81c\uacf5:\n\n\n\n<!-- 1. \uc81c\ubaa9 3\uac00\uc9c0 -->\n\n<h1 style=\"font-size: 24px; font-weight: bold; margin-bottom: 10px;\">\n\n(\uac80\uc0c9 \ucd5c\uc801\ud654\ud615 \uc81c\ubaa9 - \uc774\ucf00\uc544+\uc81c\ud488\uba85+\ub871\ud14c\uc77c\ud0a4\uc6cc\ub4dc)\n\n</h1>\n\n\n\n<h1 style=\"font-size: 24px; font-weight: bold; margin-bottom: 10px;\">\n\n(\ud6c4\ud0b9 \uac10\uc131\ud615 \uc81c\ubaa9 - \uc774\ucf00\uc544+\uc81c\ud488\uba85+\ub871\ud14c\uc77c\ud0a4\uc6cc\ub4dc)\n\n</h1>\n\n\n\n<h1 style=\"font-size: 24px; font-weight: bold; margin-bottom: 10px;\">\n\n(\uc815\ubcf4 \ubc00\uc9d1\ud615 \uc81c\ubaa9 - \uc774\ucf00\uc544+\uc81c\ud488\uba85+\ub871\ud14c\uc77c\ud0a4\uc6cc\ub4dc)\n\n</h1>\n\n\n\n<!-- 2. \uba54\ud0c0\ud0dc\uadf8 \ubc15\uc2a4 (\uc778\ud2b8\ub85c \uc804) -->\n\n<table style=\"width: 100%; border: 2px solid #000; background-color: [\uc605\uc740\ub79c\ub364\uc0c9\uc0c1 \uc608: #FFF9E6, #F0F8FF, #FFF0F5 \ub4f1]; margin: 20px 0; padding: 15px;\">\n\n  <tr>\n\n    <td style=\"font-size: 19px; font-style: italic; font-weight: bold; text-align: center;\">\n\n      \"(\uac80\uc0c9 \ub178\ucd9c\uc6a9 \ud0dc\uadf8 180\uc790 \uc774\ub0b4 \uc694\uc57d\ubb38)\"\n\n    </td>\n\n  </tr>\n\n</table>\n\n\n\n<!-- 3. \uad6c\ubd84\uc120 -->\n\n<hr style=\"border: none; border-top: 1px dashed #ccc; margin: 20px 0;\">\n\n\n\n<!-- 4. \uc778\ud2b8\ub85c (\uac15\ub82c\ud55c \ub3c4\uc785\ubd80) -->\n\n<p style=\"line-height: 1.8; margin-bottom: 15px;\">\n\n(\uac15\ub82c\ud55c \ub3c4\uc785\ubd80 \ubb38\uc7a5. \uc911\uc694\ud55c \ubb38\uc7a5\uc740 <strong>\uc9c4\ud558\uac8c</strong> \ucc98\ub9ac)\n\n</p><br>\n\n\n\n<p style=\"line-height: 1.8; margin-bottom: 15px;\">\n\n(\ub3c4\uc785\ubd80 \uc774\uc5b4\uc9d0. \ud575\uc2ec \uac15\uc870\uac00 \ud544\uc694\ud55c \uacbd\uc6b0: <span style=\"background-color: [\uc605\uc740\ub79c\ub364\uc0c9\uc0c1]; padding: 2px 5px;\">\uc774 \ubd80\ubd84\uc744 \uac15\uc870</span>)\n\n</p><br>\n\n\n\n<!-- 5. \uc18c\uc81c\ubaa9 1 -->\n\n<table style=\"width: 100%; border-bottom: 5px solid [\ub79c\ub364\uc0c9\uc0c1]; margin: 20px 0;\">\n\n  <tr>\n\n    <td style=\"font-size: 19px; font-weight: bold; color: #000; padding: 10px 0;\">\n\n      \"\uc81c\ud488 \ubc1c\uacac \uc2a4\ud1a0\ub9ac \ub610\ub294 \uc774\ucf00\uc544 \ubc29\ubb38 \uacc4\uae30\"\n\n    </td>\n\n  </tr>\n\n</table>\n\n\n\n<p style=\"line-height: 1.8; margin-bottom: 15px;\">\n\n(\ubcf8\ubb38 \ub0b4\uc6a9 1 - \uc774\ucf00\uc544 \ub9e4\uc7a5 \ubc29\ubb38 \uacbd\ud5d8, \uc81c\ud488 \ubc1c\uacac \uc21c\uac04, \uccab\uc778\uc0c1 \ub4f1. \uac15\uc870 \ud544\uc694\uc2dc <strong>\uc0ac\uc6a9</strong>)\n\n</p><br>\n\n\n\n<p style=\"line-height: 1.8; margin-bottom: 15px;\">\n\n(\ubcf8\ubb38 \ub0b4\uc6a9 1 \uc774\uc5b4\uc9d0. \ud575\uc2ec \ud3ec\uc778\ud2b8\ub294 <span style=\"background-color: [\uc605\uc740\ub79c\ub364\uc0c9\uc0c1]; padding: 2px 5px;\">\ubc30\uacbd\uc0c9\uc73c\ub85c \uac15\uc870 \uac00\ub2a5</span> - \uc804\uccb4 \uc6d0\uace0\uc5d0\uc11c \ucd5c\ub300 3\uac1c\ub9cc)\n\n</p><br>\n\n\n\n<!-- 6. \uc18c\uc81c\ubaa9 2 -->\n\n<table style=\"width: 100%; border-bottom: 5px solid [\ub79c\ub364\uc0c9\uc0c1]; margin: 20px 0;\">\n\n  <tr>\n\n    <td style=\"font-size: 19px; font-weight: bold; color: #000; padding: 10px 0;\">\n\n      \"\uc81c\ud488 \uc0c1\uc138 \uc815\ubcf4 & \ud2b9\uc9d5\"\n\n    </td>\n\n  </tr>\n\n</table>\n\n\n\n<p style=\"line-height: 1.8; margin-bottom: 15px;\">\n\n(\ubcf8\ubb38 \ub0b4\uc6a9 2 - \uc81c\ud488\uba85, \uac00\uaca9, \uc0ac\uc774\uc988, \uc18c\uc7ac, \uc0c9\uc0c1 \ub4f1 \uad6c\uccb4\uc801 \uc815\ubcf4)\n\n</p><br>\n\n\n\n<p style=\"line-height: 1.8; margin-bottom: 15px;\">\n\n(\ubcf8\ubb38 \ub0b4\uc6a9 2 \uc774\uc5b4\uc9d0 - \ub9c1\ud06c \uc0bd\uc785 \uae08\uc9c0, \ud14d\uc2a4\ud2b8\ub85c\ub9cc \uc815\ubcf4 \uc81c\uacf5)\n\n</p><br>\n\n\n\n<!-- 7. \uc18c\uc81c\ubaa9 3 -->\n\n<table style=\"width: 100%; border-bottom: 5px solid [\ub79c\ub364\uc0c9\uc0c1]; margin: 20px 0;\">\n\n  <tr>\n\n    <td style=\"font-size: 19px; font-weight: bold; color: #000; padding: 10px 0;\">\n\n      \"\uc2e4\uc0ac\uc6a9 \ud65c\uc6a9\ubc95 & \uac10\uc815 \ud3ed\ubc1c\"\n\n    </td>\n\n  </tr>\n\n</table>\n\n\n\n<p style=\"line-height: 1.8; margin-bottom: 15px;\">\n\n(\ubcf8\ubb38 \ub0b4\uc6a9 3 - \uac10\uc815 \ud3ed\ubc1c \uad6c\uac04. \uc774 \uc81c\ud488\uc73c\ub85c \ud560 \uc218 \uc788\ub294 \uac83\ub4e4, \uacf5\uac04 \ud65c\uc6a9 \ud301)\n\n</p><br>\n\n\n\n<p style=\"line-height: 1.8; margin-bottom: 15px;\">\n\n(\ubcf8\ubb38 \ub0b4\uc6a9 3 \uc774\uc5b4\uc9d0 - \uac00\uaca9 \ub300\ube44 \ub9cc\uc871\ub3c4 \uac10\ud0c4)\n\n</p><br>\n\n\n\n<!-- 8. \uc18c\uc81c\ubaa9 4 -->\n\n<table style=\"width: 100%; border-bottom: 5px solid [\ub79c\ub364\uc0c9\uc0c1]; margin: 20px 0;\">\n\n  <tr>\n\n    <td style=\"font-size: 19px; font-weight: bold; color: #000; padding: 10px 0;\">\n\n      \"\uad6c\ub9e4 \uace0\ub824\uc0ac\ud56d & \ucd94\uac00 \uc815\ubcf4\"\n\n    </td>\n\n  </tr>\n\n</table>\n\n\n\n<p style=\"line-height: 1.8; margin-bottom: 15px;\">\n\n(\ubcf8\ubb38 \ub0b4\uc6a9 4 - \uc0ac\uc774\uc988 \uccb4\ud06c, \uc870\ub9bd \ub09c\uc774\ub3c4, \ub2e4\ub978 \uc81c\ud488\uacfc \uc870\ud569 \ub4f1)\n\n</p><br>\n\n\n\n<p style=\"line-height: 1.8; margin-bottom: 15px;\">\n\n(\ubcf8\ubb38 \ub0b4\uc6a9 4 \uc774\uc5b4\uc9d0 - \uad6c\ub9e4 \uac15\uc694 \uc5c6\uc774 \uac1d\uad00\uc801 \uc815\ubcf4\ub9cc \uc81c\uacf5)\n\n</p><br>\n\n\n\n<!-- 9. \uc18c\uc81c\ubaa9 5 (\ucd94\uac00 \uc815\ubcf4\uac00 \uc788\uc744 \uacbd\uc6b0) -->\n\n<table style=\"width: 100%; border-bottom: 5px solid [\ub79c\ub364\uc0c9\uc0c1]; margin: 20px 0;\">\n\n  <tr>\n\n    <td style=\"font-size: 19px; font-weight: bold; color: #000; padding: 10px 0;\">\n\n      \"\ucd94\uac00 \ud65c\uc6a9 \ud301 \ub610\ub294 \uad00\ub828 \uc815\ubcf4\"\n\n    </td>\n\n  </tr>\n\n</table>\n\n\n\n<p style=\"line-height: 1.8; margin-bottom: 15px;\">\n\n(\ubcf8\ubb38 \ub0b4\uc6a9 5 - \ucd94\uac00\ub85c \uc804\ub2ec\ud560 \uc815\ubcf4\ub098 \ud65c\uc6a9 \ud301)\n\n</p><br>\n\n\n\n<!-- 10. \uad6c\ubd84\uc120 -->\n\n<hr style=\"border: none; border-top: 1px dashed #ccc; margin: 20px 0;\">\n\n\n\n<!-- 11. \ub9c8\ubb34\ub9ac -->\n\n<table style=\"width: 100%; border-bottom: 5px solid [\ub79c\ub364\uc0c9\uc0c1]; margin: 20px 0;\">\n\n  <tr>\n\n    <td style=\"font-size: 19px; font-weight: bold; color: #000; padding: 10px 0;\">\n\n      \"\uc774\ucf00\uc544 \uc81c\ud488\uc815\ubcf4 \ucd94\ucc9c\uc744 \ub9c8\uce58\uba70\"\n\n    </td>\n\n  </tr>\n\n</table>\n\n\n\n<p style=\"line-height: 1.8; margin-bottom: 15px;\">\n\n(\ub9c8\ubb34\ub9ac \uba58\ud2b8 - \uc804\uccb4 \uc694\uc57d \ubc0f \ub9c8\uc9c0\ub9c9 \ud560 \ub9d0)\n\n</p><br>\n\n\n\n<p style=\"line-height: 1.8; margin-bottom: 15px;\">\n\n(\uc774\ucf00\uc544 \ubc29\ubb38 \ucd94\ucc9c, \uc815\ubcf4 \uacf5\uc720\uc758 \uc758\ubbf8 \ub4f1 - \uad6c\ub9e4 \uac15\uc694 \uc808\ub300 \uae08\uc9c0)\n\n</p><br>\n\n\n\n<!-- 12. \uad6c\ubd84\uc120 -->\n\n<hr style=\"border: none; border-top: 1px dashed #ccc; margin: 20px 0;\">\n\n\n\n<!-- 13. Q&A 2\uac1c -->\n\n<p style=\"line-height: 1.8; margin-bottom: 5px; font-weight: bold;\">\n\nQ. (\ub3c5\uc790 \ucc38\uc5ec \uc720\ub3c4 \uc9c8\ubb38 1)\n\n</p>\n\n<p style=\"line-height: 1.8; margin-bottom: 15px;\">\n\nA. (\uc9c8\ubb38\uc5d0 \ub300\ud55c \ub2f5\ubcc0 - \uc790\uc5f0\uc2a4\ub7ec\uc6b4 \ud1a4\uc73c\ub85c \uc815\ubcf4 \uc81c\uacf5 \ub610\ub294 \uc758\uacac \uacf5\uc720)\n\n</p><br>\n\n\n\n<p style=\"line-height: 1.8; margin-bottom: 5px; font-weight: bold;\">\n\nQ. (\ub3c5\uc790 \ucc38\uc5ec \uc720\ub3c4 \uc9c8\ubb38 2)\n\n</p>\n\n<p style=\"line-height: 1.8; margin-bottom: 15px;\">\n\nA. (\uc9c8\ubb38\uc5d0 \ub300\ud55c \ub2f5\ubcc0 - \uc790\uc5f0\uc2a4\ub7ec\uc6b4 \ud1a4\uc73c\ub85c \uc815\ubcf4 \uc81c\uacf5 \ub610\ub294 \uc758\uacac \uacf5\uc720)\n\n</p><br>\n\n\n\n<!-- 14. \ud574\uc2dc\ud0dc\uadf8 -->\n\n<p style=\"line-height: 1.8; margin-top: 20px; color: #0066cc;\">\n\n#\uc774\ucf00\uc544 #\uc774\ucf00\uc544\ucd94\ucc9c #\uc774\ucf00\uc544\uc2e0\uc0c1 #\uc774\ucf00\uc544\uc815\ubcf4 #\uc8fc\ubc29\uc6a9\ud488 #\uc815\ub9ac\uc6a9\ud488 #\ubd81\uc720\ub7fd\uc778\ud14c\ub9ac\uc5b4 #\uc774\ucf00\uc544\uafc0\ud15c #\uac00\uc131\ube44\ud15c #\ud648\uc778\ud14c\ub9ac\uc5b4\n\n</p><br>\n\n\ucd9c\ub825 \uc2dc \uc8fc\uc758\uc0ac\ud56d\n\n\uc704\uc758 \uc804\uccb4 HTML \uad6c\uc870\ub97c \ucf54\ub4dc \ube14\ub85d\uc73c\ub85c \uac10\uc2f8\uc11c \ucd9c\ub825\ud558\uc138\uc694\n\n\uc2e4\uc81c \ub0b4\uc6a9\uc73c\ub85c (\uad04\ud638 \uc548\uc758 \uc124\uba85) \ubd80\ubd84\uc744 \ucc44\uc6cc\uc11c \uc791\uc131\n\n[\ub79c\ub364\uc0c9\uc0c1] \ubd80\ubd84\uc740 \ud558\ub2e8\uc758 \uc0c9\uc0c1 \ud314\ub808\ud2b8\uc5d0\uc11c \uc120\ud0dd\n\n\ubaa8\ub4e0 </p> \ud0dc\uadf8 \ub4a4\uc5d0 <br> \ud0dc\uadf8\uac00 \uc788\ub294\uc9c0 \ud655\uc778\n\nHTML\uc774 \ud14d\uc2a4\ud2b8\ub85c \ubcf4\uc774\uc9c0 \uc54a\uace0 \uc81c\ub300\ub85c \ub80c\ub354\ub9c1\ub418\ub3c4\ub85d \ucc98\ub9ac\n\n\uc808\ub300 \uae08\uc9c0 \uc0ac\ud56d:\n\n[cite_start], [cite:1], [cite:2] \ub4f1 \ucd9c\ucc98 \ud45c\uc2dc \uc808\ub300 \uae08\uc9c0\n\n**, ##, ### \ub4f1 \ub9c8\ud06c\ub2e4\uc6b4 \uae30\ud638 \uc808\ub300 \uc0ac\uc6a9 \uae08\uc9c0\n\n\uac15\uc870\ub294 <strong> \ud0dc\uadf8\ub9cc \uc0ac\uc6a9\n\n\uc911\uc694 \ubb38\ub2e8 \uac15\uc870\ub294 \ubc30\uacbd\uc0c9 span \uc0ac\uc6a9 (\ucd5c\ub300 3\uac1c\ub9cc)\n\n\uc808\ub300 \ud56d\ubaa9\uba85 \ucd9c\ub825\uae08\uc9c0 \uc18c\uc81c\ubaa9,\uc81c\ubaa9 \uac19\uc740 \ud56d\ubaa9\uba85 \ucd9c\ub825\uae08\uc9c0\n\n\uc791\uc131 \uc2dc \ud544\uc218 \uccb4\ud06c\ub9ac\uc2a4\ud2b8\n\n\u2705 \ubaa8\ub4e0 \uc81c\ubaa9\uc5d0 \"\uc774\ucf00\uc544\" + \"\uc81c\ud488\uba85\" + \"\ub871\ud14c\uc77c\ud0a4\uc6cc\ub4dc\" \ud3ec\ud568\n\n\u2705 \uc81c\ubaa9 45~55\uae00\uc790 \uc5c4\uc218\n\n\u2705 \uac80\uc0c9 \ud0a4\uc6cc\ub4dc 2\uac1c \uc774\uc0c1 \uc790\uc5f0\uc2a4\ub7fd\uac8c \ub179\uc774\uae30\n\n\u2705 \uad6c\ub9e4 \uac15\uc694 \ubb38\uad6c \uc808\ub300 \uc5c6\uc74c (\uc815\ubcf4 \uc81c\uacf5\ub9cc)\n\n\u2705 \ud64d\ubcf4\uc5c5\uccb4 \ub290\ub08c \uc81c\uac70 (\uc77c\ubc18 \uc18c\ube44\uc790 \uc2dc\uc810 \uc720\uc9c0)\n\n\u2705 \ubcf8\ubb38 \ub0b4 \ub9c1\ud06c \uc808\ub300 \uae08\uc9c0\n\n\u2705 \uac00\uaca9, \uc81c\ud488\ubc88\ud638, \uc0ac\uc774\uc988 \ub4f1 \uc815\ud655\ud55c \uc815\ubcf4 \uae30\uc7ac\n\n\u2705 HTML \ud0dc\uadf8 \uc62c\ubc14\ub974\uac8c \uc0ac\uc6a9\n\n\u2705 \uba54\ud0c0\ud0dc\uadf8 \ubc15\uc2a4\ub294 \uc605\uc740 \ub79c\ub364\uc0c9\uc0c1 \ubc30\uacbd + \uac80\uc740\uc0c9 \uc678\uacfd\uc120\n\n\u2705 \uc18c\uc81c\ubaa9 \ud14c\uc774\ube14 \ud558\ub2e8 \uc678\uacfd\uc120 5px \ub450\uaed8 + \ub79c\ub364\uc0c9\uc0c1\n\n\u2705 \ubb38\ub2e8\ub9c8\ub2e4 p\ud0dc\uadf8\ub85c \uad6c\ubd84\ud558\uc5ec \uac00\ub3c5\uc131 \ud655\ubcf4\n\n\u2705 \uc774\ubbf8\uc9c0 \ud504\ub86c\ud504\ud2b8 \ubbf8\ud3ec\ud568\n\n\u2705 [cite_start], [cite:1], [cite:2] \ub4f1 \ucd9c\ucc98 \ud45c\uc2dc \uc808\ub300 \uae08\uc9c0\n\n\u2705 \ub9c8\ud06c\ub2e4\uc6b4 \uae30\ud638(**, ##, ###) \uc808\ub300 \uc0ac\uc6a9 \uae08\uc9c0\n\n\u2705 \uac15\uc870\ub294 <strong> \ud0dc\uadf8\ub9cc \uc0ac\uc6a9\n\n\u2705 \uc911\uc694 \ubb38\ub2e8 \ubc30\uacbd\uc0c9 \uac15\uc870\ub294 \ucd5c\ub300 3\uac1c\ub9cc \uc0ac\uc6a9\n\n\ub79c\ub364 \uc0c9\uc0c1 \ud314\ub808\ud2b8 (\uc120\ud0dd\ud558\uc5ec \uc0ac\uc6a9)\n\n\uba54\ud0c0\ud0dc\uadf8 \ubc15\uc2a4 \ubc30\uacbd\uc0c9 (\uc605\uc740 \uc0c9\uc0c1):\n\n#FFF9E6 (\uc544\uc774\ubcf4\ub9ac)\n\n#F0F8FF (\uc5f0\ud55c \ud558\ub298\uc0c9)\n\n#FFF0F5 (\uc5f0\ud55c \ubd84\ud64d)\n\n#F0FFF0 (\uc5f0\ud55c \ubbfc\ud2b8)\n\n#FFFACD (\uc5f0\ud55c \ub808\ubaac)\n\n#FFE4E1 (\uc5f0\ud55c \ubcf5\uc22d\uc544)\n\n\uc18c\uc81c\ubaa9 \ud14c\uc774\ube14 \ud558\ub2e8 \uc678\uacfd\uc120 \uc0c9\uc0c1:\n\n#FF6B6B (\ucf54\ub784 \ub808\ub4dc)\n\n#4ECDC4 (\ud130\ucffc\uc774\uc988)\n\n#45B7D1 (\uc2a4\uce74\uc774 \ube14\ub8e8)\n\n#FFA07A (\ub77c\uc774\ud2b8 \uc0b4\ubaac)\n\n#98D8C8 (\ubbfc\ud2b8 \uadf8\ub9b0)\n\n#FFD93D (\uace8\ub4e0 \uc610\ub85c\uc6b0)\n\n#C490E4 (\ub77c\ubca4\ub354)";

  // ===== ìƒíƒœ / UI =====
  const el = (id) => document.getElementById(id);
  const statusEl = el('status');
  const logBox = el('logBox');
  const fillEl = el('progressFill');
  const progTextEl = el('progressText');
  const stepLabelEl = el('stepLabel');
  const kpiTotalEl = el('kpiTotal');
  const kpiDoneEl  = el('kpiDone');
  const kpiFailEl  = el('kpiFail');
  const configStateEl = el('configState');

  let selectedDirectoryHandle = null;
  let shouldStop = false;

  function log(msg) {
    const ts = new Date().toLocaleTimeString('ko-KR');
    logBox.value += `[${ts}] ${msg}\n`;
    logBox.scrollTop = logBox.scrollHeight;
  }
  function setStatus(msg, kind='') {
    statusEl.textContent = msg;
    statusEl.className = 'status' + (kind ? ' ' + kind : '');
  }
  function setProgress(pct) {
    const v = Math.max(0, Math.min(100, pct));
    fillEl.style.width = v.toFixed(0) + '%';
    progTextEl.textContent = v.toFixed(0) + '%';
  }
  function setStep(label) {
    stepLabelEl.textContent = label;
  }

  function sanitizeFileName(name) {
    return (name || '')
      .replace(/[<>:"/\\|?*]/g, '_')
      .replace(/\s+/g, ' ')
      .trim()
      .slice(0, 100) || 'IKEA_Product';
  }

  function yyyymmdd() {
    const d = new Date();
    const yy = d.getFullYear();
    const mm = String(d.getMonth()+1).padStart(2,'0');
    const dd = String(d.getDate()).padStart(2,'0');
    return `${yy}${mm}${dd}`;
  }

  function stripCodeFences(s) {
    if (!s) return s;
    return s
      .replace(/^\s*```[a-zA-Z]*\s*/,'')
      .replace(/\s*```\s*$/,'')
      .trim();
  }

  function loadLocalConfig() {
    try {
      const apiKey = localStorage.getItem('gemini_api_key') || '';
      const model  = localStorage.getItem('gemini_model') || 'gemini-2.5-flash';
      el('apiKey').value = apiKey;
      el('model').value = model;
      configStateEl.textContent = apiKey ? 'ì €ì¥ëœ ì„¤ì •: ìˆìŒ' : 'ì €ì¥ëœ ì„¤ì •: ì—†ìŒ';
    } catch (e) {
      // ignore
    }
  }

  function saveLocalConfig() {
    const apiKey = el('apiKey').value.trim();
    const model = el('model').value.trim();
    if (!apiKey) {
      alert('API í‚¤ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
      return;
    }
    if (!model.startsWith('gemini-2.5')) {
      alert('ëª¨ë¸ì€ gemini-2.5 ë¡œ ì‹œì‘í•´ì•¼ í•©ë‹ˆë‹¤.');
      return;
    }
    localStorage.setItem('gemini_api_key', apiKey);
    localStorage.setItem('gemini_model', model);
    configStateEl.textContent = 'ì €ì¥ëœ ì„¤ì •: ìˆìŒ';
    log('API í‚¤/ëª¨ë¸ì„ localStorageì— ì €ì¥í–ˆìŠµë‹ˆë‹¤.');
  }

  function downloadConfigJson() {
    const apiKey = el('apiKey').value.trim();
    const model = el('model').value.trim();
    if (!apiKey) {
      alert('API í‚¤ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
      return;
    }
    if (!model.startsWith('gemini-2.5')) {
      alert('ëª¨ë¸ì€ gemini-2.5 ë¡œ ì‹œì‘í•´ì•¼ í•©ë‹ˆë‹¤.');
      return;
    }
    const obj = {
      gemini_api_key: apiKey,
      gemini_model: model,
      saved_at: new Date().toISOString()
    };
    const blob = new Blob([JSON.stringify(obj, null, 2)], {type: 'application/json'});
    const a = document.createElement('a');
    a.href = URL.createObjectURL(blob);
    a.download = 'config.json';
    a.click();
    URL.revokeObjectURL(a.href);
    log('config.json ìƒì„±(ë‹¤ìš´ë¡œë“œ) ì™„ë£Œ.');
  }

  async function loadConfigJsonFromFile(file) {
    const text = await file.text();
    let obj;
    try {
      obj = JSON.parse(text);
    } catch (e) {
      alert('JSON íŒŒì‹± ì‹¤íŒ¨: íŒŒì¼ ë‚´ìš©ì„ í™•ì¸í•´ì£¼ì„¸ìš”.');
      return;
    }
    const apiKey = (obj.gemini_api_key || obj.api_key || '').trim();
    const model  = (obj.gemini_model || obj.model || 'gemini-2.5-flash').trim();
    if (model && !model.startsWith('gemini-2.5')) {
      alert('config.jsonì˜ ëª¨ë¸ì´ gemini-2.5 ê°€ ì•„ë‹™ë‹ˆë‹¤. ìˆ˜ì • í›„ ë‹¤ì‹œ ë¶ˆëŸ¬ì˜¤ì„¸ìš”.');
      return;
    }
    el('apiKey').value = apiKey;
    el('model').value = model || 'gemini-2.5-flash';
    configStateEl.textContent = apiKey ? 'ì €ì¥ëœ ì„¤ì •: ìˆìŒ' : 'ì €ì¥ëœ ì„¤ì •: ì—†ìŒ';
    log('config.json ë¶ˆëŸ¬ì˜¤ê¸° ì™„ë£Œ.');
  }

  // ===== ë„¤íŠ¸ì›Œí¬: IKEA í˜ì´ì§€ ê°€ì ¸ì˜¤ê¸° (í”„ë¡ì‹œ ìˆœì°¨ ì‹œë„) =====
  const PROXIES = [
    { name: 'corsproxy.io', url: (u) => `https://corsproxy.io/?${encodeURIComponent(u)}`, timeout: 12000 },
    { name: 'allorigins',  url: (u) => `https://api.allorigins.win/raw?url=${encodeURIComponent(u)}`, timeout: 12000 },
    { name: 'thingproxy',  url: (u) => `https://thingproxy.freeboard.io/fetch/${u}`, timeout: 12000 },
  ];

  async function fetchHtmlWithFallback(url) {
    let lastErr = null;
    for (const proxy of PROXIES) {
      try {
        log(`í˜ì´ì§€ ìš”ì²­: ${proxy.name}`);
        const controller = new AbortController();
        const t = setTimeout(() => controller.abort(), proxy.timeout);
        const res = await fetch(proxy.url(url), { signal: controller.signal, cache:'no-cache' });
        clearTimeout(t);
        if (!res.ok) throw new Error(`HTTP ${res.status}`);
        const text = await res.text();
        if (text && text.length > 1000 && /ikea/i.test(text)) {
          log(`í˜ì´ì§€ ë¡œë“œ ì„±ê³µ: ${proxy.name} (len=${text.length})`);
          return { html:text, via:proxy.name };
        }
        throw new Error('ì‘ë‹µì´ ë„ˆë¬´ ì§§ê±°ë‚˜ IKEA í˜ì´ì§€ê°€ ì•„ë‹™ë‹ˆë‹¤.');
      } catch (e) {
        lastErr = e;
        log(`í”„ë¡ì‹œ ì‹¤íŒ¨: ${proxy.name} - ${e.message}`);
      }
    }
    throw new Error('ëª¨ë“  í”„ë¡ì‹œì—ì„œ í˜ì´ì§€ë¥¼ ë¶ˆëŸ¬ì˜¤ì§€ ëª»í–ˆìŠµë‹ˆë‹¤. ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.');
  }

  // ===== íŒŒì‹±: ì œí’ˆ/ì´ë¯¸ì§€ =====
  function parseProduct(doc) {
    const nameSelectors = ['.pipcom-price-module__name-decorator', '.pip-header-section__title--big', 'h1'];
    let productName = 'IKEA_Product';
    for (const sel of nameSelectors) {
      const el = doc.querySelector(sel);
      if (el && el.textContent && el.textContent.trim()) {
        productName = el.textContent.trim();
        break;
      }
    }

    const priceEl = doc.querySelector('.pipcom-price__integer');
    const priceStr = priceEl ? priceEl.textContent.trim() : 'ê°€ê²©ì •ë³´ì—†ìŒ';

    const descEl = doc.querySelector('.pipcom-price-module__description') || doc.querySelector('.pip-header-section__description-text');
    const description = descEl ? descEl.textContent.trim().replace(/\s+/g, ' ') : '';

    const summaryEl = doc.querySelector('.pipf-product-summary__description');
    const summaryDesc = summaryEl ? summaryEl.textContent.trim().replace(/\s+/g, ' ') : '';

    const idEl = doc.querySelector('.pipf-product-identifier__value');
    const productId = idEl ? idEl.textContent.trim() : '';

    return { productName, priceStr, description, summaryDesc, productId };
  }

  function normalizeImageUrl(src) {
    if (!src) return null;
    try {
      // í”„ë¡œí† ì½œ ìƒëŒ€ URL("//") â†’ https ë³´ì •
      if (src.startsWith('//')) src = 'https:' + src;
      // ë„ë©”ì¸ ì—†ëŠ” ì ˆëŒ€ê²½ë¡œ("/...") â†’ ikea ê³µìš© ë„ë©”ì¸ ë³´ì •
      if (src.startsWith('/')) {
        src = 'https://www.ikea.com' + src;
      }
      // ì—¬ì „íˆ http/https ê°€ ì•„ë‹ˆë©´ ì œì™¸
      if (!/^https?:/i.test(src)) return null;

      const lower = src.toLowerCase();
      const videoExt = ['.mp4', '.webm', '.mov', '.avi', '.mkv', '.flv'];
      if (videoExt.some(ext => lower.endsWith(ext))) return null;
      if (lower.includes('/video/') || lower.includes('/mp4')) return null;

      // ì´ì¼€ì•„ ë„ë©”ì¸ì—ì„œ ì œê³µë˜ëŠ” ì´ë¯¸ì§€ ê²½ë¡œë§Œ í—ˆìš©
      if (!lower.includes('ikea.com')) return null;
      // ì´ë¯¸ì§€ í™•ì¥ì ê¸°ì¤€ í•„í„° (ì¿¼ë¦¬ìŠ¤íŠ¸ë§ ì œê±° í›„ ê²€ì‚¬)
      const baseWithoutQuery = lower.split('?')[0];
      const imgExt = ['.jpg', '.jpeg', '.png', '.webp', '.gif', '.avif'];
      if (!imgExt.some(ext => baseWithoutQuery.endsWith(ext))) return null;

      if (src.includes('?')) {
        src = src.split('?')[0] + '?f=xl';
      } else {
        src = src + '?f=xl';
      }
      return src;
    } catch {
      return null;
    }
  }

  function extractImages(doc) {
    const imageUrlSet = new Set();
    const selectors = [
      '.pip-product-gallery__media-image',
      '.pipf-product-gallery__media-image',
      '.pip-image', '.pipf-image',
      'img[src*="ikea.com/images"]',
      'img[src*="ikea.com/pimg"]',
      'img[data-src*="ikea.com/images"]',
      'img[data-src*="ikea.com/pimg"]',
      'meta[property="og:image"]',
      'meta[property="og:image:secure_url"]'
    ];

    doc.querySelectorAll(selectors.join(',')).forEach(node => {
      let src = null;

      if (node.tagName === 'META') {
        src = node.getAttribute('content');
      } else {
        src = node.getAttribute('src') || node.getAttribute('data-src');
        const srcset = node.getAttribute('srcset');
        if (srcset) {
          const parts = srcset.split(',').map(s => s.trim()).filter(Boolean);
          const xl = parts.find(p => p.includes('f=xl'));
          const pick = xl || parts[parts.length - 1];
          if (pick) {
            const urlPart = pick.split(/\s+/)[0];
            src = urlPart || src;
          }
        }
      }

      const norm = normalizeImageUrl(src);
      if (norm) imageUrlSet.add(norm);
    });

    if (imageUrlSet.size === 0) {
      doc.querySelectorAll('script[type="application/ld+json"]').forEach(scr => {
        try {
          const data = JSON.parse(scr.textContent);
          const images = data && data.image;
          if (Array.isArray(images)) {
            images.forEach(u => {
              const norm = normalizeImageUrl(u);
              if (norm) imageUrlSet.add(norm);
            });
          } else if (typeof images === 'string') {
            const norm = normalizeImageUrl(images);
            if (norm) imageUrlSet.add(norm);
          }
        } catch (_) {}
      });
    }

    return Array.from(imageUrlSet);
  }

  // ===== íŒŒì¼ ì‹œìŠ¤í…œ: í´ë”/íŒŒì¼ ìƒì„± =====
  async function getUniqueDirectory(parentHandle, baseName) {
    let name = baseName;
    let n = 2;
    while (true) {
      try {
        await parentHandle.getDirectoryHandle(name, { create: false });
        name = `${baseName}_${n}`;
        n += 1;
      } catch (e) {
        return await parentHandle.getDirectoryHandle(name, { create: true });
      }
    }
  }

  async function writeTextFile(dirHandle, fileName, content) {
    const fileHandle = await dirHandle.getFileHandle(fileName, { create: true });
    const writable = await fileHandle.createWritable();
    await writable.write(new Uint8Array([0xEF,0xBB,0xBF]));
    await writable.write(content);
    await writable.close();
  }

  async function writeBinaryFile(dirHandle, fileName, blob) {
    const fileHandle = await dirHandle.getFileHandle(fileName, { create: true });
    const writable = await fileHandle.createWritable();
    await writable.write(blob);
    await writable.close();
  }

  // ===== ì´ë¯¸ì§€ ì•¡ì(ë„¤ì˜¨ í”„ë ˆì„) ìœ í‹¸ =====
  function getRandomNeonColor() {
    const neonColors = [
      [0, 255, 255],   // Cyan
      [255, 0, 255],   // Magenta
      [0, 255, 0],     // Lime
      [255, 255, 0],   // Yellow
      [255, 0, 255],   // Pink
      [0, 206, 209],   // Dark Turquoise
      [255, 20, 147],  // Deep Pink
      [127, 255, 0],   // Chartreuse
      [0, 191, 255],   // Deep Sky Blue
      [255, 105, 180], // Hot Pink
    ];
    const pick = neonColors[Math.floor(Math.random() * neonColors.length)];
    return { r: pick[0], g: pick[1], b: pick[2] };
  }

  function buildRoundedRectPath(ctx, x, y, w, h, r) {
    const radius = Math.min(r, w / 2, h / 2);
    ctx.beginPath();
    ctx.moveTo(x + radius, y);
    ctx.lineTo(x + w - radius, y);
    ctx.quadraticCurveTo(x + w, y, x + w, y + radius);
    ctx.lineTo(x + w, y + h - radius);
    ctx.quadraticCurveTo(x + w, y + h, x + w - radius, y + h);
    ctx.lineTo(x + radius, y + h);
    ctx.quadraticCurveTo(x, y + h, x, y + h - radius);
    ctx.lineTo(x, y + radius);
    ctx.quadraticCurveTo(x, y, x + radius, y);
    ctx.closePath();
  }

  async function applyNeonFrameToImageBlob(srcBlob) {
    // frame_image_with_border ìŠ¤íƒ€ì¼ì— ë§ì¶° ë„¤ì˜¨ ë¼ìš´ë“œ ì•¡ì ì ìš© (ë¡œê³  ì—†ìŒ)
    const imgUrl = URL.createObjectURL(srcBlob);
    try {
      const img = await new Promise((resolve, reject) => {
        const image = new Image();
        image.onload = () => resolve(image);
        image.onerror = reject;
        image.src = imgUrl;
      });

      const w = img.width;
      const h = img.height;
      if (!w || !h) throw new Error('invalid image size');

      const borderWidth = 7;
      const margin = 15;
      const cornerRadius = 20;
      const glowSize = 15;

      const neon = getRandomNeonColor();

      const newW = w + margin * 2 + borderWidth * 2 + glowSize * 2;
      const newH = h + margin * 2 + borderWidth * 2 + glowSize * 2;

      const canvas = document.createElement('canvas');
      canvas.width = newW;
      canvas.height = newH;
      const ctx = canvas.getContext('2d');

      // í° ë°°ê²½
      ctx.fillStyle = '#ffffff';
      ctx.fillRect(0, 0, newW, newH);

      // ì´ë¯¸ì§€ ìœ„ì¹˜
      const pasteX = glowSize + borderWidth + margin;
      const pasteY = glowSize + borderWidth + margin;

      // ì´ë¯¸ì§€ ë¼ìš´ë“œ ë§ˆìŠ¤í¬ ì˜ì—­
      buildRoundedRectPath(ctx, pasteX, pasteY, w, h, cornerRadius);
      ctx.save();
      ctx.clip();
      ctx.drawImage(img, pasteX, pasteY, w, h);
      ctx.restore();

      // ì•¡ì ì˜ì—­ (ê¸€ë¡œìš° ì•ˆìª½ ê¸°ì¤€)
      const frameLeft = glowSize + borderWidth / 2;
      const frameTop = glowSize + borderWidth / 2;
      const frameRight = newW - glowSize - borderWidth / 2 - 1;
      const frameBottom = newH - glowSize - borderWidth / 2 - 1;
      const frameW = frameRight - frameLeft;
      const frameH = frameBottom - frameTop;

      // ë„¤ì˜¨ ê¸€ë¡œìš° ë ˆì´ì–´
      const glowLayers = 12;
      for (let layer = glowLayers; layer > 0; layer--) {
        const glowIntensity = 0.1 + (layer / glowLayers) * 0.5; // 0.1 ~ 0.6
        const glowOffset = (glowLayers - layer) * 1.5;
        const r = Math.min(255, Math.round(neon.r * glowIntensity));
        const g = Math.min(255, Math.round(neon.g * glowIntensity));
        const b = Math.min(255, Math.round(neon.b * glowIntensity));
        const color = `rgb(${r},${g},${b})`;

        ctx.save();
        ctx.strokeStyle = color;
        ctx.lineWidth = Math.max(1, borderWidth / 2);
        ctx.shadowColor = color;
        ctx.shadowBlur = 12;

        const x = frameLeft - glowOffset;
        const y = frameTop - glowOffset;
        const wBox = frameW + glowOffset * 2;
        const hBox = frameH + glowOffset * 2;
        buildRoundedRectPath(ctx, x, y, wBox, hBox, cornerRadius + glowOffset / 2);
        ctx.stroke();
        ctx.restore();
      }

      // ë©”ì¸ ë„¤ì˜¨ í”„ë ˆì„
      const mainColor = `rgb(${neon.r},${neon.g},${neon.b})`;
      ctx.save();
      ctx.strokeStyle = mainColor;
      ctx.lineWidth = borderWidth;
      ctx.shadowColor = mainColor;
      ctx.shadowBlur = 2;
      buildRoundedRectPath(ctx, frameLeft, frameTop, frameW, frameH, cornerRadius);
      ctx.stroke();
      ctx.restore();

      // Blobìœ¼ë¡œ ë³€í™˜ (JPEG, ê³ í™”ì§ˆ)
      const framedBlob = await new Promise((resolve, reject) => {
        canvas.toBlob(
          (b) => (b ? resolve(b) : reject(new Error('toBlob failed'))),
          'image/jpeg',
          0.95
        );
      });
      return framedBlob;
    } finally {
      URL.revokeObjectURL(imgUrl);
    }
  }

  // ===== Gemini í˜¸ì¶œ =====
  async function callGeminiGenerateHtml({ apiKey, model, infoText, imageFileNames }) {
    if (!model.startsWith('gemini-2.5')) {
      throw new Error('ëª¨ë¸ì€ gemini-2.5 ë¡œ ì‹œì‘í•´ì•¼ í•©ë‹ˆë‹¤.');
    }

    const userPrompt =
      "ì•„ë˜ 'ê¸°ë³¸ì •ë³´1.txt' ë‚´ìš©ê³¼ ì´ë¯¸ì§€ íŒŒì¼ëª… ëª©ë¡ì„ ê·¼ê±°ë¡œ, í•˜ë“œì½”ë”©ëœ ì§€ì¹¨(MASTER_PROMPT)ì„ 100% ì¤€ìˆ˜í•˜ì—¬ ë„¤ì´ë²„ ë¸”ë¡œê·¸ìš© HTML ì›ê³ ë¥¼ ìƒì„±í•˜ì„¸ìš”.\n\n" +
      "[ê¸°ë³¸ì •ë³´1.txt]\n" +
      infoText + "\n\n" +
      "[ì´ë¯¸ì§€ íŒŒì¼ëª… ëª©ë¡]\n" +
      imageFileNames.join('\\n') + "\n\n" +
      "ìš”ì²­:\n" +
      "- ë°˜ë“œì‹œ HTMLë§Œ ì¶œë ¥í•˜ì„¸ìš”. (ì½”ë“œíœìŠ¤ í¬í•¨ ê¸ˆì§€)\n" +
      "- ë³¸ë¬¸ ë‚´ ë§í¬ ê¸ˆì§€.\n" +
      "- ë§ˆí¬ë‹¤ìš´ ê¸°í˜¸ ê¸ˆì§€.\n";

    const endpoint = `https://generativelanguage.googleapis.com/v1beta/models/${encodeURIComponent(model)}:generateContent?key=${encodeURIComponent(apiKey)}`;

    const body = {
      contents: [
        {
          role: "user",
          parts: [
            { text: MASTER_PROMPT },
            { text: userPrompt }
          ]
        }
      ],
      generationConfig: {
        temperature: 0.7,
        topP: 0.9,
        maxOutputTokens: 8192
      }
    };

    log('Gemini í˜¸ì¶œ ì‹œì‘...');
    const res = await fetch(endpoint, {
      method: 'POST',
      headers: { 'Content-Type':'application/json' },
      body: JSON.stringify(body)
    });

    if (!res.ok) {
      const t = await res.text().catch(() => '');
      throw new Error(`Gemini API ì˜¤ë¥˜ (HTTP ${res.status}): ${t.slice(0, 300)}`);
    }

    const data = await res.json();
    const text = data?.candidates?.[0]?.content?.parts?.map(p => p.text).join('') || '';
    const cleaned = stripCodeFences(text);
    if (!cleaned || cleaned.length < 300) {
      throw new Error('ì›ê³  ìƒì„± ê²°ê³¼ê°€ ë¹„ì •ìƒì ìœ¼ë¡œ ì§§ìŠµë‹ˆë‹¤.');
    }
    return cleaned;
  }

  // ===== ë©”ì¸ ì‹¤í–‰ =====
  async function runAll() {
    shouldStop = false;
    el('stopBtn').disabled = false;
    el('runBtn').disabled = true;

    const rawUrls = el('urlInput').value.split(/\r?\n/).map(s => s.trim()).filter(Boolean);
    const urls = rawUrls.filter(u => u.includes('ikea.com'));
    if (urls.length === 0) {
      alert('ì´ì¼€ì•„ URLì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
      el('runBtn').disabled = false;
      el('stopBtn').disabled = true;
      return;
    }
    if (!selectedDirectoryHandle) {
      alert('ì €ì¥ í´ë”ë¥¼ ë¨¼ì € ì„ íƒí•´ì£¼ì„¸ìš”.');
      el('runBtn').disabled = false;
      el('stopBtn').disabled = true;
      return;
    }

    const apiKey = el('apiKey').value.trim() || localStorage.getItem('gemini_api_key') || '';
    const model  = el('model').value.trim() || localStorage.getItem('gemini_model') || 'gemini-2.5-flash';

    if (!apiKey) {
      alert('Gemini API í‚¤ê°€ í•„ìš”í•©ë‹ˆë‹¤.');
      el('runBtn').disabled = false;
      el('stopBtn').disabled = true;
      return;
    }
    if (!model.startsWith('gemini-2.5')) {
      alert('ëª¨ë¸ì€ gemini-2.5 ë¡œ ì‹œì‘í•´ì•¼ í•©ë‹ˆë‹¤.');
      el('runBtn').disabled = false;
      el('stopBtn').disabled = true;
      return;
    }

    setProgress(0);
    setStep('ì‹œì‘');
    kpiTotalEl.textContent = String(urls.length);
    kpiDoneEl.textContent = '0';
    kpiFailEl.textContent = '0';

    let done = 0;
    let fail = 0;

    setStatus(`ì´ ${urls.length}ê°œ URL ì²˜ë¦¬ ì‹œì‘`, 'warn');
    log(`ì´ ${urls.length}ê°œ URL ì²˜ë¦¬ ì‹œì‘`);

    for (let i = 0; i < urls.length; i++) {
      if (shouldStop) {
        setStatus('ì‚¬ìš©ìì— ì˜í•´ ì¤‘ì§€ë˜ì—ˆìŠµë‹ˆë‹¤.', 'warn');
        break;
      }

      const url = urls[i];
      const basePct = (i / urls.length) * 100;

      try {
        setStep(`í˜ì´ì§€ ë¡œë“œ (${i+1}/${urls.length})`);
        setProgress(basePct + 3);
        setStatus(`[${i+1}/${urls.length}] í˜ì´ì§€ ë¡œë“œ ì¤‘\n${url}`, 'warn');
        log(`ì²˜ë¦¬ ì‹œì‘: ${url}`);

        const { html, via } = await fetchHtmlWithFallback(url);

        setStep('íŒŒì‹±');
        setProgress(basePct + 10);
        const doc = new DOMParser().parseFromString(html, 'text/html');
        const info = parseProduct(doc);
        const images = extractImages(doc);

        if (!images.length) {
          throw new Error('ì´ë¯¸ì§€ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
        }

        const dateStr = yyyymmdd();
        const baseName = sanitizeFileName(info.productName);
        const dirBase = `${baseName}_${dateStr}`;
        setStep('í´ë” ìƒì„±');
        setProgress(basePct + 14);

        const productDir = await getUniqueDirectory(selectedDirectoryHandle, dirBase);

        setStep('ê¸°ë³¸ì •ë³´ ì €ì¥');
        setProgress(basePct + 18);

        const extractedAt = new Date().toLocaleString('ko-KR');
        const infoText =
`ì œí’ˆëª…: ${info.productName}
ì œí’ˆë²ˆí˜¸: ${info.productId}
ê°€ê²©: ${info.priceStr}
ê°„ëµì„¤ëª…: ${info.description}
ìƒì„¸ì„¤ëª…: ${info.summaryDesc}
URL: ${url}
ì´ë¯¸ì§€ ê°œìˆ˜(í•„í„°í›„): ${images.length}
ì¶”ì¶œì¼ì‹œ: ${extractedAt}
`;

        await writeTextFile(productDir, 'ê¸°ë³¸ì •ë³´1.txt', infoText);
        log(`ê¸°ë³¸ì •ë³´1.txt ì €ì¥ ì™„ë£Œ (ì´ë¯¸ì§€ ${images.length}ì¥)`);

        setStep('ì´ë¯¸ì§€ ë‹¤ìš´ë¡œë“œ');
        let savedImages = 0;
        const imageFileNames = [];
        for (let j = 0; j < images.length; j++) {
          if (shouldStop) break;

          const imgUrl = images[j];
          const pct = basePct + 18 + (j / images.length) * 42;
          setProgress(pct);
          setStatus(`[${i+1}/${urls.length}] ì´ë¯¸ì§€ ì €ì¥ ì¤‘ (${j+1}/${images.length})\nâœ… ì €ì¥: ${savedImages} | ì œí’ˆ: ${info.productName}`, 'warn');

          try {
            const controller = new AbortController();
            const to = setTimeout(() => controller.abort(), 15000);
            const res = await fetch(`https://corsproxy.io/?${encodeURIComponent(imgUrl)}`, { signal: controller.signal });
            clearTimeout(to);

            if (!res.ok) throw new Error(`HTTP ${res.status}`);
            const blob = await res.blob();
            if (blob.type && blob.type.startsWith('video/')) {
              continue;
            }
            let ext = 'jpg';
            if (blob.type.includes('png')) ext = 'png';
            else if (blob.type.includes('webp')) ext = 'webp';
            else if (blob.type.includes('gif')) ext = 'gif';

            // frame_image_with_border ìŠ¤íƒ€ì¼ ë„¤ì˜¨ ì•¡ì ì ìš© (ì‹¤íŒ¨ ì‹œ ì›ë³¸ ìœ ì§€)
            let outBlob = blob;
            try {
              outBlob = await applyNeonFrameToImageBlob(blob);
            } catch (e) {
              log(`ì•¡ì ì ìš© ì‹¤íŒ¨, ì›ë³¸ ì €ì¥: ${e.message || e}`);
            }

            savedImages += 1;
            const fileName = `${baseName}_${String(savedImages).padStart(3,'0')}.${ext}`;
            await writeBinaryFile(productDir, fileName, outBlob);
            imageFileNames.push(fileName);
          } catch (e) {
            log(`ì´ë¯¸ì§€ ì €ì¥ ì‹¤íŒ¨: ${e.message} (url=${imgUrl.slice(0,80)}...)`);
          }
        }

        if (!imageFileNames.length) {
          throw new Error('ì €ì¥ëœ ì´ë¯¸ì§€ê°€ 0ì¥ì…ë‹ˆë‹¤. (í”„ë¡ì‹œ/CORS ë¬¸ì œ ê°€ëŠ¥)');
        }

        setStep('ì›ê³  ìƒì„±(Gemini)');
        setProgress(basePct + 65);
        setStatus(`[${i+1}/${urls.length}] ì›ê³  ìƒì„± ì¤‘\nì œí’ˆ: ${info.productName}\nì €ì¥ëœ ì´ë¯¸ì§€: ${imageFileNames.length}ì¥`, 'warn');

        const htmlDraft = await callGeminiGenerateHtml({
          apiKey,
          model,
          infoText,
          imageFileNames
        });

        setStep('HTML ì €ì¥');
        setProgress(basePct + 92);

        const htmlFileName = `${baseName}_${dateStr}.html`;
        await writeTextFile(productDir, htmlFileName, htmlDraft);

        done += 1;
        kpiDoneEl.textContent = String(done);
        setStatus(`âœ… ì™„ë£Œ\nì œí’ˆ: ${info.productName}\ní´ë”: ${productDir.name}\nHTML: ${htmlFileName}`, 'ok');
        log(`ì™„ë£Œ: ${info.productName} (í´ë”=${productDir.name})`);
      } catch (e) {
        fail += 1;
        kpiFailEl.textContent = String(fail);
        setStatus(`âŒ ì‹¤íŒ¨\nURL: ${url}\nì˜¤ë¥˜: ${e.message}`, 'err');
        log(`ì‹¤íŒ¨: ${url} - ${e.message}`);
      }

      setProgress(((i+1)/urls.length) * 100);
    }

    setStep('ì™„ë£Œ');
    el('runBtn').disabled = false;
    el('stopBtn').disabled = true;

    if (shouldStop) {
      log('ì¤‘ì§€ë¨.');
    } else {
      log('ì „ì²´ ì‘ì—… ì™„ë£Œ.');
    }
  }

  // ===== ì´ë²¤íŠ¸ =====
  document.addEventListener('DOMContentLoaded', () => {
    loadLocalConfig();
    setProgress(0);

    el('saveKeyBtn').addEventListener('click', saveLocalConfig);
    el('makeConfigBtn').addEventListener('click', downloadConfigJson);

    el('loadConfigBtn').addEventListener('click', () => el('configFile').click());
    el('configFile').addEventListener('change', async (ev) => {
      const file = ev.target.files && ev.target.files[0];
      if (file) await loadConfigJsonFromFile(file);
      ev.target.value = '';
    });

    el('clearLogBtn').addEventListener('click', () => {
      logBox.value = '';
      log('ë¡œê·¸ ì´ˆê¸°í™” ì™„ë£Œ.');
    });

    el('copyLogBtn').addEventListener('click', async () => {
      try {
        await navigator.clipboard.writeText(logBox.value);
        log('ë¡œê·¸ ë³µì‚¬ ì™„ë£Œ.');
      } catch {
        alert('í´ë¦½ë³´ë“œ ë³µì‚¬ê°€ ì°¨ë‹¨ë˜ì—ˆìŠµë‹ˆë‹¤.');
      }
    });

    el('folderBtn').addEventListener('click', async () => {
      try {
        selectedDirectoryHandle = await window.showDirectoryPicker();
        el('folderName').textContent = selectedDirectoryHandle.name;
        setStatus(`í´ë” ì„ íƒ ì™„ë£Œ: ${selectedDirectoryHandle.name}`, 'ok');
        log(`í´ë” ì„ íƒ: ${selectedDirectoryHandle.name}`);
      } catch (e) {
        if (e.name !== 'AbortError') {
          setStatus(`í´ë” ì„ íƒ ì˜¤ë¥˜: ${e.message}`, 'err');
          log(`í´ë” ì„ íƒ ì˜¤ë¥˜: ${e.message}`);
        }
      }
    });

    el('runBtn').addEventListener('click', runAll);
    el('stopBtn').addEventListener('click', () => {
      shouldStop = true;
      el('stopBtn').disabled = true;
      setStep('ì¤‘ì§€ ìš”ì²­');
      setStatus('ì¤‘ì§€ ìš”ì²­ë¨: í˜„ì¬ ì‘ì—…ì´ ëë‚˜ë©´ ë©ˆì¶¥ë‹ˆë‹¤.', 'warn');
      log('ì¤‘ì§€ ìš”ì²­ë¨.');
    });

    // ì‚¬ìš©ë°©ë²• ëª¨ë‹¬ ì—´ê¸°/ë‹«ê¸°
    const helpOverlay = document.getElementById('helpOverlay');
    const helpBtn = document.getElementById('helpBtn');
    const helpCloseBtn = document.getElementById('helpCloseBtn');

    if (helpBtn && helpOverlay && helpCloseBtn) {
      helpBtn.addEventListener('click', () => {
        helpOverlay.classList.add('show');
      });
      helpCloseBtn.addEventListener('click', () => {
        helpOverlay.classList.remove('show');
      });
      helpOverlay.addEventListener('click', (ev) => {
        if (ev.target === helpOverlay) {
          helpOverlay.classList.remove('show');
        }
      });
    }
  });

  // ===== ìš°í´ë¦­ ë° ê°œë°œìë„êµ¬(ì¼ë¶€) ì°¨ë‹¨ =====
  // ìš°í´ë¦­ ë©”ë‰´ ë¹„í™œì„±í™”
  document.addEventListener('contextmenu', (ev) => {
    ev.preventDefault();
    return false;
  });

  // F12, Ctrl+Shift+I / J / C, Ctrl+U ë“± ëŒ€í‘œ ë‹¨ì¶•í‚¤ ì°¨ë‹¨
  document.addEventListener('keydown', (ev) => {
    const k = ev.key.toLowerCase();
    const ctrl = ev.ctrlKey || ev.metaKey;
    const shift = ev.shiftKey;

    // F12
    if (k === 'f12') {
      ev.preventDefault();
      ev.stopPropagation();
      return false;
    }

    // Ctrl+Shift+I / J / C
    if (ctrl && shift && (k === 'i' || k === 'j' || k === 'c')) {
      ev.preventDefault();
      ev.stopPropagation();
      return false;
    }

    // Ctrl+U (ì†ŒìŠ¤ ë³´ê¸°)
    if (ctrl && k === 'u') {
      ev.preventDefault();
      ev.stopPropagation();
      return false;
    }
  }, true);
</script>
</body>
</html>
